[0m21:16:11.392694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A25D6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A54980B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A54990A0>]}


============================== 21:16:11.410233 | 1e1f034c-22c5-43d5-9d27-99dec4c99eec ==============================
[0m21:16:11.410233 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:16:11.411829 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m21:16:14.701915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A271FCE0>]}
[0m21:16:14.805520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A7128C50>]}
[0m21:16:14.809713 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:16:15.314982 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:16:15.316545 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:16:15.316545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A70D7E60>]}
[0m21:16:16.876300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.iplanrio_desafio.silver
- models.iplanrio_desafio.gold
[0m21:16:16.886870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A76CD940>]}
[0m21:16:16.977537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:16:16.979552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:16:17.047329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A77001A0>]}
[0m21:16:17.047329 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m21:16:17.047329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A77E6CF0>]}
[0m21:16:17.047329 [info ] [MainThread]: 
[0m21:16:17.054724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:17.054724 [info ] [MainThread]: 
[0m21:16:17.054724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:16:17.062445 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m21:16:17.382652 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m21:16:17.387743 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m21:16:17.387743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:21.904154 [debug] [ThreadPool]: SQL status: OK in 4.517 seconds
[0m21:16:21.904154 [debug] [ThreadPool]: On list_terceirizados: Close
[0m21:16:21.904154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m21:16:21.904154 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m21:16:21.917991 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:16:21.917991 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m21:16:21.917991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:21.923527 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:16:21.924201 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:16:21.924201 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m21:16:21.924201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:16:21.924201 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:16:21.924201 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m21:16:21.924201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:16:21.924201 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:16:21.924201 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:16:21.924201 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:16:21.924201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:16:21.924201 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m21:16:21.933284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m21:16:21.934380 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:16:21.934380 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m21:16:21.934380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:21.934380 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:16:21.934380 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:16:21.934380 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m21:16:21.954402 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:16:21.960852 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m21:16:21.960852 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m21:16:21.964636 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m21:16:21.965255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A76E7620>]}
[0m21:16:21.965255 [debug] [MainThread]: Using duckdb connection "master"
[0m21:16:21.965255 [debug] [MainThread]: On master: BEGIN
[0m21:16:21.965255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:21.965255 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:16:21.965255 [debug] [MainThread]: On master: COMMIT
[0m21:16:21.965255 [debug] [MainThread]: Using duckdb connection "master"
[0m21:16:21.965255 [debug] [MainThread]: On master: COMMIT
[0m21:16:21.965255 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:16:21.965255 [debug] [MainThread]: On master: Close
[0m21:16:22.006913 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m21:16:22.006913 [info ] [Thread-1 (]: 1 of 1 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m21:16:22.006913 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m21:16:22.006913 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m21:16:22.013430 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:16:22.033726 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m21:16:22.071762 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:16:22.071762 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:16:22.071762 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m21:16:22.071762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:16:22.071762 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:16:22.071762 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:16:22.071762 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

SELECT 
    * FROM read_parquet('s3://iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m21:16:26.705396 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: HTTP Error: Unable to connect to URL "http://localhost:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet": 404 (NOT FOUND).

LINE 8:     * FROM read_parquet('s3://iplanrio-bucket/raw/terceirizados_2025...
                   ^
[0m21:16:26.706631 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

SELECT 
    * FROM read_parquet('s3://iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m21:16:26.707390 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:16:26.707922 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m21:16:26.711892 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m21:16:26.715289 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m21:16:26.723912 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  HTTP Error: Unable to connect to URL "http://localhost:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet": 404 (NOT FOUND).
  
  LINE 8:     * FROM read_parquet('s3://iplanrio-bucket/raw/terceirizados_2025...
                     ^
[0m21:16:26.727841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1f034c-22c5-43d5-9d27-99dec4c99eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A7C00EC0>]}
[0m21:16:26.727841 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 4.72s]
[0m21:16:26.732493 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m21:16:26.732493 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  HTTP Error: Unable to connect to URL "http://localhost:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet": 404 (NOT FOUND).
  
  LINE 8:     * FROM read_parquet('s3://iplanrio-bucket/raw/terceirizados_2025...
                     ^.
[0m21:16:26.734714 [debug] [MainThread]: Using duckdb connection "master"
[0m21:16:26.734714 [debug] [MainThread]: On master: BEGIN
[0m21:16:26.734714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:26.734714 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:16:26.742597 [debug] [MainThread]: On master: COMMIT
[0m21:16:26.743218 [debug] [MainThread]: Using duckdb connection "master"
[0m21:16:26.744119 [debug] [MainThread]: On master: COMMIT
[0m21:16:26.744119 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:16:26.744119 [debug] [MainThread]: On master: Close
[0m21:16:26.744119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:26.747387 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m21:16:26.747387 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m21:16:26.747387 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m21:16:26.747387 [info ] [MainThread]: 
[0m21:16:26.749400 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m21:16:26.750464 [debug] [MainThread]: Command end result
[0m21:16:26.791671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:16:26.796301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:16:26.804694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m21:16:26.809012 [info ] [MainThread]: 
[0m21:16:26.810034 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:16:26.810034 [info ] [MainThread]: 
[0m21:16:26.810034 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m21:16:26.810034 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  HTTP Error: Unable to connect to URL "http://localhost:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet": 404 (NOT FOUND).
  
  LINE 8:     * FROM read_parquet('s3://iplanrio-bucket/raw/terceirizados_2025...
                     ^
[0m21:16:26.810034 [info ] [MainThread]: 
[0m21:16:26.815270 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m21:16:26.817056 [info ] [MainThread]: 
[0m21:16:26.818004 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:16:26.820055 [debug] [MainThread]: Command `dbt run` failed at 21:16:26.820055 after 16.04 seconds
[0m21:16:26.820055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A568B080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A731FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A76A1370>]}
[0m21:16:26.820055 [debug] [MainThread]: Flushing usage events
[0m21:16:28.140306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:54.158481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F58B6EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F297D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F5301E80>]}


============================== 21:22:54.168517 | 196158a7-d4e9-481e-bc3d-771fa33b9fb9 ==============================
[0m21:22:54.168517 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:22:54.168517 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m21:22:54.958162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F5931580>]}
[0m21:22:55.063032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F535A720>]}
[0m21:22:55.066028 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:22:55.858931 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:22:56.149396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:22:56.149396 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\bronze\terceirizados_bronze.sql
[0m21:22:56.550068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.iplanrio_desafio.silver
- models.iplanrio_desafio.gold
[0m21:22:56.569760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F759F380>]}
[0m21:22:56.652080 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:22:56.654088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:22:56.731818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F756CF50>]}
[0m21:22:56.731818 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m21:22:56.731818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F58B43E0>]}
[0m21:22:56.737742 [info ] [MainThread]: 
[0m21:22:56.737742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:56.742064 [info ] [MainThread]: 
[0m21:22:56.742064 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:22:56.745209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m21:22:56.931738 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m21:22:56.933879 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m21:22:56.933879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:58.645444 [debug] [ThreadPool]: SQL status: OK in 1.711 seconds
[0m21:22:58.651243 [debug] [ThreadPool]: On list_terceirizados: Close
[0m21:22:58.654310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m21:22:58.656970 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m21:22:58.675155 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:22:58.676356 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m21:22:58.676356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:58.683423 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:22:58.685451 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:22:58.687462 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m21:22:58.688973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:22:58.688973 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:22:58.690495 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m21:22:58.691094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:22:58.694646 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:22:58.694646 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:22:58.694646 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:22:58.697679 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:22:58.697679 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m21:22:58.701367 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m21:22:58.827493 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:22:58.828040 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m21:22:58.828583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:58.831297 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:22:58.832902 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:22:58.833955 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m21:22:58.891770 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m21:22:58.893779 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m21:22:58.894803 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m21:22:58.897134 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m21:22:58.897134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F76117C0>]}
[0m21:22:58.897134 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:58.897134 [debug] [MainThread]: On master: BEGIN
[0m21:22:58.897134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:58.900040 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:22:58.902049 [debug] [MainThread]: On master: COMMIT
[0m21:22:58.903057 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:58.904171 [debug] [MainThread]: On master: COMMIT
[0m21:22:58.904171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:22:58.904171 [debug] [MainThread]: On master: Close
[0m21:22:58.927220 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m21:22:58.927220 [info ] [Thread-1 (]: 1 of 1 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m21:22:58.927220 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m21:22:58.927220 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m21:22:58.945730 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:58.950501 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m21:22:59.016102 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:59.024131 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:59.030155 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m21:22:59.030155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:22:59.032535 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:22:59.032535 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:59.032535 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m21:22:59.378915 [debug] [Thread-1 (]: SQL status: OK in 0.344 seconds
[0m21:22:59.388972 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:59.390175 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m21:22:59.391267 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:22:59.406552 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m21:22:59.406552 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:59.406552 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m21:22:59.406552 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:22:59.416736 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:22:59.416736 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m21:22:59.420034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:22:59.422639 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m21:22:59.424650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196158a7-d4e9-481e-bc3d-771fa33b9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F722ABA0>]}
[0m21:22:59.424650 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.50s]
[0m21:22:59.427161 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m21:22:59.429485 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:59.429485 [debug] [MainThread]: On master: BEGIN
[0m21:22:59.429485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:59.429485 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:22:59.429485 [debug] [MainThread]: On master: COMMIT
[0m21:22:59.429485 [debug] [MainThread]: Using duckdb connection "master"
[0m21:22:59.429485 [debug] [MainThread]: On master: COMMIT
[0m21:22:59.429485 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:22:59.429485 [debug] [MainThread]: On master: Close
[0m21:22:59.429485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:59.429485 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m21:22:59.429485 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m21:22:59.429485 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m21:22:59.429485 [info ] [MainThread]: 
[0m21:22:59.429485 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m21:22:59.437303 [debug] [MainThread]: Command end result
[0m21:22:59.465534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:22:59.470493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:22:59.478869 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m21:22:59.480108 [info ] [MainThread]: 
[0m21:22:59.480108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:22:59.480108 [info ] [MainThread]: 
[0m21:22:59.480108 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:22:59.480108 [debug] [MainThread]: Command `dbt run` succeeded at 21:22:59.480108 after 5.57 seconds
[0m21:22:59.480108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F4BA3A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F74CD3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F5067CE0>]}
[0m21:22:59.480108 [debug] [MainThread]: Flushing usage events
[0m21:23:00.790292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:57.835698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B1DB7B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B1DB4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B22EF8C0>]}


============================== 21:28:57.845837 | 6213e631-9907-4c8a-9562-f729d69c8479 ==============================
[0m21:28:57.845837 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:28:57.845837 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m21:28:58.705657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B3BF0740>]}
[0m21:28:58.809267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B1BC7FE0>]}
[0m21:28:58.809267 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:28:59.500856 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:28:59.675140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:59.675140 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:28:59.675140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:59.688356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.iplanrio_desafio.silver
- models.iplanrio_desafio.gold
[0m21:28:59.727520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B3C93D70>]}
[0m21:28:59.830846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:28:59.830846 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:28:59.906818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B3E7A090>]}
[0m21:28:59.910879 [info ] [MainThread]: Found 1 model, 1 source, 474 macros
[0m21:28:59.912885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B3C90DD0>]}
[0m21:28:59.914393 [info ] [MainThread]: 
[0m21:28:59.914393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:28:59.914393 [info ] [MainThread]: 
[0m21:28:59.918948 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:28:59.922281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m21:29:00.238872 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m21:29:00.244674 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m21:29:00.245181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:01.639988 [debug] [ThreadPool]: SQL status: OK in 1.395 seconds
[0m21:29:01.642003 [debug] [ThreadPool]: On list_terceirizados: Close
[0m21:29:01.645630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m21:29:01.645630 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m21:29:01.650309 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:29:01.650309 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m21:29:01.650309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:01.655838 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:29:01.655838 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:29:01.655838 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m21:29:01.655838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:01.655838 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:29:01.655838 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m21:29:01.655838 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:29:01.665543 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:29:01.666049 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:29:01.666624 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:29:01.666624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:01.666624 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m21:29:01.666624 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m21:29:01.676370 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:29:01.678437 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m21:29:01.678437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:01.678437 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:29:01.681518 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:29:01.682095 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m21:29:01.713275 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m21:29:01.715406 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m21:29:01.717915 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m21:29:01.717915 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m21:29:01.717915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B25B39B0>]}
[0m21:29:01.717915 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:01.717915 [debug] [MainThread]: On master: BEGIN
[0m21:29:01.717915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:01.717915 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:29:01.724558 [debug] [MainThread]: On master: COMMIT
[0m21:29:01.724558 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:01.724558 [debug] [MainThread]: On master: COMMIT
[0m21:29:01.724558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:01.724558 [debug] [MainThread]: On master: Close
[0m21:29:01.793233 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m21:29:01.793233 [info ] [Thread-1 (]: 1 of 1 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m21:29:01.801109 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m21:29:01.801109 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m21:29:01.811753 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:01.826196 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m21:29:01.884029 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:01.906076 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:01.907196 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m21:29:01.907196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:01.907196 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:01.907196 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:01.907196 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m21:29:02.248842 [debug] [Thread-1 (]: SQL status: OK in 0.338 seconds
[0m21:29:02.255963 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:02.255963 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m21:29:02.260090 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:29:02.264144 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:02.265105 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m21:29:02.265105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:02.280038 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m21:29:02.280038 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:02.280038 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m21:29:02.288327 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:29:02.293496 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:29:02.293496 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m21:29:02.299135 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:29:02.300699 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m21:29:02.300699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6213e631-9907-4c8a-9562-f729d69c8479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B4449880>]}
[0m21:29:02.300699 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.50s]
[0m21:29:02.305331 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m21:29:02.305331 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:02.305331 [debug] [MainThread]: On master: BEGIN
[0m21:29:02.305331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:02.310978 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m21:29:02.310978 [debug] [MainThread]: On master: COMMIT
[0m21:29:02.310978 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:02.310978 [debug] [MainThread]: On master: COMMIT
[0m21:29:02.310978 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:02.310978 [debug] [MainThread]: On master: Close
[0m21:29:02.310978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:02.310978 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m21:29:02.310978 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m21:29:02.310978 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m21:29:02.310978 [info ] [MainThread]: 
[0m21:29:02.310978 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m21:29:02.319437 [debug] [MainThread]: Command end result
[0m21:29:02.350836 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:29:02.352980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:29:02.360277 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m21:29:02.360277 [info ] [MainThread]: 
[0m21:29:02.364771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:02.366516 [info ] [MainThread]: 
[0m21:29:02.367068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:29:02.368782 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:02.368782 after 4.89 seconds
[0m21:29:02.369344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B4240140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B3F1A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3B0B552E0>]}
[0m21:29:02.369900 [debug] [MainThread]: Flushing usage events
[0m21:29:03.696260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:52.201897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EB266B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EE0A4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EE0A7200>]}


============================== 21:56:52.266934 | c65ab083-d069-488e-85ba-92cd3f1ace94 ==============================
[0m21:56:52.266934 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:56:52.275192 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m21:56:53.938343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EE065B20>]}
[0m21:56:54.207087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EFD2D160>]}
[0m21:56:54.214967 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:56:55.274475 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:56:55.469552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:56:55.469552 [debug] [MainThread]: Partial parsing: added file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m21:56:55.469552 [debug] [MainThread]: Partial parsing: added file: iplanrio_desafio://models\gold\terceirizados.sql
[0m21:56:55.801901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7F047CB00>]}
[0m21:56:55.901494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:56:55.905381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:56:55.965036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7F0518C80>]}
[0m21:56:55.965036 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m21:56:55.965036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7F046A120>]}
[0m21:56:55.969193 [info ] [MainThread]: 
[0m21:56:55.969193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:55.969193 [info ] [MainThread]: 
[0m21:56:55.969193 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:56:55.977867 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m21:56:56.249411 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m21:56:56.249411 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m21:56:56.249411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:57.445831 [debug] [ThreadPool]: SQL status: OK in 1.196 seconds
[0m21:56:57.447840 [debug] [ThreadPool]: On list_terceirizados: Close
[0m21:56:57.449858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m21:56:57.449858 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m21:56:57.532225 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:56:57.537120 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m21:56:57.537120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:57.541805 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:56:57.542384 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:56:57.542384 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m21:56:57.542384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:56:57.542384 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:56:57.542384 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m21:56:57.547426 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:56:57.549469 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:56:57.549988 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m21:56:57.549988 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m21:56:57.549988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:56:57.552010 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m21:56:57.552010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m21:56:57.558281 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:56:57.558281 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m21:56:57.558281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:57.558281 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:56:57.568460 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m21:56:57.568460 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m21:56:57.616155 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m21:56:57.616155 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m21:56:57.619960 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m21:56:57.620598 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m21:56:57.621341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EFD7BAA0>]}
[0m21:56:57.623646 [debug] [MainThread]: Using duckdb connection "master"
[0m21:56:57.625357 [debug] [MainThread]: On master: BEGIN
[0m21:56:57.626368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:57.626368 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:56:57.626368 [debug] [MainThread]: On master: COMMIT
[0m21:56:57.626368 [debug] [MainThread]: Using duckdb connection "master"
[0m21:56:57.626368 [debug] [MainThread]: On master: COMMIT
[0m21:56:57.630967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:56:57.630967 [debug] [MainThread]: On master: Close
[0m21:56:57.651088 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m21:56:57.651600 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m21:56:57.652265 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m21:56:57.652265 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m21:56:57.662097 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:57.667699 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m21:56:57.714075 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:57.714075 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:57.714075 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m21:56:57.721986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:56:57.724937 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:56:57.724937 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:57.727757 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m21:56:58.052196 [debug] [Thread-1 (]: SQL status: OK in 0.323 seconds
[0m21:56:58.063495 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:58.065507 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m21:56:58.067524 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:56:58.083924 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m21:56:58.083924 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:58.083924 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m21:56:58.092132 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:56:58.104484 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m21:56:58.105597 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m21:56:58.108491 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:56:58.108491 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m21:56:58.113249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7F035B1D0>]}
[0m21:56:58.113249 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.46s]
[0m21:56:58.113249 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m21:56:58.113249 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m21:56:58.113249 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m21:56:58.113249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m21:56:58.113249 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m21:56:58.164789 [debug] [Thread-1 (]: Compilation Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  'proper_br' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:56:58.167587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c65ab083-d069-488e-85ba-92cd3f1ace94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7F02D8290>]}
[0m21:56:58.167587 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.05s]
[0m21:56:58.167587 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m21:56:58.167587 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  'proper_br' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:56:58.167587 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m21:56:58.175270 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m21:56:58.176268 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m21:56:58.178432 [debug] [MainThread]: Using duckdb connection "master"
[0m21:56:58.178432 [debug] [MainThread]: On master: BEGIN
[0m21:56:58.178432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:58.182780 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:56:58.182780 [debug] [MainThread]: On master: COMMIT
[0m21:56:58.182780 [debug] [MainThread]: Using duckdb connection "master"
[0m21:56:58.182780 [debug] [MainThread]: On master: COMMIT
[0m21:56:58.182780 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:56:58.182780 [debug] [MainThread]: On master: Close
[0m21:56:58.186706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:58.186706 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m21:56:58.186706 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m21:56:58.186706 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m21:56:58.186706 [info ] [MainThread]: 
[0m21:56:58.186706 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m21:56:58.191944 [debug] [MainThread]: Command end result
[0m21:56:58.230920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m21:56:58.241231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m21:56:58.251184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m21:56:58.254608 [info ] [MainThread]: 
[0m21:56:58.254608 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:56:58.254608 [info ] [MainThread]: 
[0m21:56:58.258698 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m21:56:58.260835 [error] [MainThread]:   Compilation Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  'proper_br' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:56:58.261344 [info ] [MainThread]: 
[0m21:56:58.261344 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m21:56:58.263475 [debug] [MainThread]: Command `dbt run` failed at 21:56:58.263475 after 6.70 seconds
[0m21:56:58.265485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EE064D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EE067380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EE0655B0>]}
[0m21:56:58.265485 [debug] [MainThread]: Flushing usage events
[0m21:56:59.693557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:38.353594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB520D6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54C28A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB517FA0F0>]}


============================== 13:27:38.445029 | 469979ca-0c31-473a-942c-1ef46e906fa9 ==============================
[0m13:27:38.445029 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:27:38.445029 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:27:38.465566 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.silver.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m13:27:38.472865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '469979ca-0c31-473a-942c-1ef46e906fa9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB567FDF70>]}
[0m13:27:40.287764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '469979ca-0c31-473a-942c-1ef46e906fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB566B4140>]}
[0m13:27:40.446037 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:27:40.448933 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:27:40.449425 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:27:40.454042 [debug] [MainThread]: Command `dbt deps` succeeded at 13:27:40.453466 after 2.86 seconds
[0m13:27:40.455456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB566B5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB568796A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB547F9790>]}
[0m13:27:40.455456 [debug] [MainThread]: Flushing usage events
[0m13:27:43.076933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:56.795676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F656F5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F656F5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F656F7B00>]}


============================== 13:27:56.812686 | 9e8296e0-3224-4e0c-9052-4083c4456137 ==============================
[0m13:27:56.812686 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:27:56.817028 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:27:58.609554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F65772A50>]}
[0m13:27:58.795906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F656F6810>]}
[0m13:27:58.800810 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:27:59.491278 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:27:59.853910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:59.856528 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m13:28:00.509630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F66DC25A0>]}
[0m13:28:00.653835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:28:00.658956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:28:00.732702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F67014F80>]}
[0m13:28:00.733218 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m13:28:00.733218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F67277110>]}
[0m13:28:00.738440 [info ] [MainThread]: 
[0m13:28:00.740465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:00.742719 [info ] [MainThread]: 
[0m13:28:00.742719 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:00.754437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m13:28:01.158112 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m13:28:01.159553 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m13:28:01.159553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:02.841414 [debug] [ThreadPool]: SQL status: OK in 1.688 seconds
[0m13:28:02.852386 [debug] [ThreadPool]: On list_terceirizados: Close
[0m13:28:02.855259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m13:28:02.855259 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m13:28:02.872208 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:28:02.872208 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m13:28:02.874332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:02.874332 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:28:02.874332 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:28:02.874332 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m13:28:02.881842 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:02.882427 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:28:02.882427 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m13:28:02.882427 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:28:02.887810 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m13:28:02.887810 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:28:02.889834 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m13:28:02.889834 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:28:02.889834 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m13:28:02.892852 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m13:28:02.996886 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m13:28:02.996886 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m13:28:03.002519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:03.002519 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:28:03.007285 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m13:28:03.007899 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m13:28:03.054318 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m13:28:03.057102 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m13:28:03.061288 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m13:28:03.062301 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m13:28:03.064332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F623235F0>]}
[0m13:28:03.064332 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:03.066347 [debug] [MainThread]: On master: BEGIN
[0m13:28:03.066347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:03.068368 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:28:03.069890 [debug] [MainThread]: On master: COMMIT
[0m13:28:03.070990 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:03.070990 [debug] [MainThread]: On master: COMMIT
[0m13:28:03.073022 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:28:03.073022 [debug] [MainThread]: On master: Close
[0m13:28:03.105956 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:03.107978 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m13:28:03.111008 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m13:28:03.111008 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:03.131568 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.133691 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:03.219715 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.223892 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.226321 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m13:28:03.226882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:03.229947 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:28:03.231974 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.233729 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m13:28:03.734270 [debug] [Thread-1 (]: SQL status: OK in 0.499 seconds
[0m13:28:03.748973 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.748973 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m13:28:03.753967 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:28:03.761665 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.763204 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m13:28:03.765327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:28:03.800686 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m13:28:03.802454 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.803565 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m13:28:03.809751 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:28:03.824853 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:03.826851 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m13:28:03.831267 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:28:03.835834 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m13:28:03.846131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6222B200>]}
[0m13:28:03.847488 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.73s]
[0m13:28:03.852209 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:03.854377 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m13:28:03.854377 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m13:28:03.857416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m13:28:03.858835 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m13:28:03.867149 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m13:28:03.869572 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m13:28:03.966723 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m13:28:03.970749 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m13:28:03.971828 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m13:28:03.973855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:03.976906 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:28:03.978748 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m13:28:03.979273 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m13:28:04.019031 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id" not found in FROM clause!
Candidate bindings: "Year"

LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                  ^
[0m13:28:04.020472 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m13:28:04.020979 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:28:04.022937 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m13:28:04.029020 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m13:28:04.030631 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m13:28:04.044398 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m13:28:04.046064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e8296e0-3224-4e0c-9052-4083c4456137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6770FDA0>]}
[0m13:28:04.047449 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.19s]
[0m13:28:04.050636 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m13:28:04.052157 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^.
[0m13:28:04.055688 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m13:28:04.057308 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m13:28:04.059176 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m13:28:04.062748 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:04.064238 [debug] [MainThread]: On master: BEGIN
[0m13:28:04.065474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:04.069476 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m13:28:04.071405 [debug] [MainThread]: On master: COMMIT
[0m13:28:04.072592 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:04.073707 [debug] [MainThread]: On master: COMMIT
[0m13:28:04.074730 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:04.076051 [debug] [MainThread]: On master: Close
[0m13:28:04.078356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:04.079129 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m13:28:04.080060 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m13:28:04.083100 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m13:28:04.083100 [info ] [MainThread]: 
[0m13:28:04.088476 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m13:28:04.093223 [debug] [MainThread]: Command end result
[0m13:28:04.175051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:28:04.186196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:28:04.212786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m13:28:04.212786 [info ] [MainThread]: 
[0m13:28:04.215361 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:28:04.217372 [info ] [MainThread]: 
[0m13:28:04.220418 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m13:28:04.222446 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m13:28:04.225412 [info ] [MainThread]: 
[0m13:28:04.228051 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m13:28:04.230442 [info ] [MainThread]: 
[0m13:28:04.232177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m13:28:04.237730 [debug] [MainThread]: Command `dbt run` failed at 13:28:04.237004 after 8.21 seconds
[0m13:28:04.238395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F64AD2CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F64D39DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F64EE5CA0>]}
[0m13:28:04.241944 [debug] [MainThread]: Flushing usage events
[0m13:28:05.663038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:18.058020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023146235070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231496418B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023149CD9520>]}


============================== 13:28:18.073861 | edcea7e4-b3f3-4f6f-b337-796d94df378e ==============================
[0m13:28:18.073861 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:28:18.076669 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:28:19.376620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edcea7e4-b3f3-4f6f-b337-796d94df378e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314A1EF260>]}
[0m13:28:19.766615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edcea7e4-b3f3-4f6f-b337-796d94df378e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231496BBEC0>]}
[0m13:28:19.782966 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:28:20.797272 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:28:21.334430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:21.336314 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:28:21.336314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:21.472151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edcea7e4-b3f3-4f6f-b337-796d94df378e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314BCD4AD0>]}
[0m13:28:21.758945 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:28:21.770903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:28:21.845249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edcea7e4-b3f3-4f6f-b337-796d94df378e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314C106660>]}
[0m13:28:21.845249 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m13:28:21.847277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edcea7e4-b3f3-4f6f-b337-796d94df378e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314BA912E0>]}
[0m13:28:21.853434 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:28:21.858792 [debug] [MainThread]: Command end result
[0m13:28:21.901568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:28:21.905271 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:28:21.910992 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m13:28:21.913001 [debug] [MainThread]: Command `dbt test` succeeded at 13:28:21.913001 after 4.33 seconds
[0m13:28:21.918528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023149C12F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023149C11EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002314A2649B0>]}
[0m13:28:21.919736 [debug] [MainThread]: Flushing usage events
[0m13:28:23.034273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:30.462597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001530F4B6A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153124B2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001530EBDE1B0>]}


============================== 13:28:30.468064 | b710bae9-ce8f-41d7-a4e8-afd969729245 ==============================
[0m13:28:30.468064 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:28:30.470482 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:28:30.931469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b710bae9-ce8f-41d7-a4e8-afd969729245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153122B7B60>]}
[0m13:28:31.073680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b710bae9-ce8f-41d7-a4e8-afd969729245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015314122420>]}
[0m13:28:31.083642 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:28:31.495191 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:28:31.650434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:31.650434 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:28:31.650434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:31.702889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b710bae9-ce8f-41d7-a4e8-afd969729245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531425E420>]}
[0m13:28:31.735741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b710bae9-ce8f-41d7-a4e8-afd969729245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153145D77D0>]}
[0m13:28:31.737757 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m13:28:31.738778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b710bae9-ce8f-41d7-a4e8-afd969729245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153142A63F0>]}
[0m13:28:31.741093 [info ] [MainThread]: 
[0m13:28:31.745184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:31.745184 [info ] [MainThread]: 
[0m13:28:31.748028 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:31.756478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m13:28:31.878884 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m13:28:31.880081 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m13:28:31.880081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:33.136436 [debug] [ThreadPool]: SQL status: OK in 1.256 seconds
[0m13:28:33.136436 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m13:28:33.138456 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m13:28:33.255586 [debug] [ThreadPool]: SQL status: OK in 0.117 seconds
[0m13:28:33.255586 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m13:28:33.261543 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m13:28:33.261543 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m13:28:33.261543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b710bae9-ce8f-41d7-a4e8-afd969729245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531403BC50>]}
[0m13:28:33.322932 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:33.322932 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m13:28:33.322932 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:33.334641 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m13:28:33.334641 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:33.338260 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m13:28:33.338260 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m13:28:33.340019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m13:28:33.340019 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m13:28:33.343907 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m13:28:33.345915 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m13:28:33.345915 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m13:28:33.347925 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m13:28:33.347925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m13:28:33.347925 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m13:28:33.355305 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m13:28:33.358371 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m13:28:33.358371 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m13:28:33.358371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:33.363574 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m13:28:33.363574 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m13:28:33.363574 [debug] [MainThread]: Command end result
[0m13:28:33.473616 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:28:33.476765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:28:33.489001 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m13:28:33.494793 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m13:28:33.494793 [info ] [MainThread]: Building catalog
[0m13:28:33.507723 [debug] [ThreadPool]: Acquiring new duckdb connection 'terceirizados.information_schema'
[0m13:28:33.514745 [debug] [ThreadPool]: Using duckdb connection "terceirizados.information_schema"
[0m13:28:33.518271 [debug] [ThreadPool]: On terceirizados.information_schema: BEGIN
[0m13:28:33.518271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:33.522982 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:28:33.522982 [debug] [ThreadPool]: Using duckdb connection "terceirizados.information_schema"
[0m13:28:33.522982 [debug] [ThreadPool]: On terceirizados.information_schema: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "terceirizados.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'terceirizados'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'terceirizados'
    )
    select
        'terceirizados' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main') or upper(r.schema_name) = upper('s3_raw'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m13:28:33.540736 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:28:33.550581 [debug] [ThreadPool]: On terceirizados.information_schema: ROLLBACK
[0m13:28:33.550581 [debug] [ThreadPool]: Failed to rollback 'terceirizados.information_schema'
[0m13:28:33.550581 [debug] [ThreadPool]: On terceirizados.information_schema: Close
[0m13:28:33.571200 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\desafio_iplanrio\target\catalog.json
[0m13:28:33.602780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:28:33.608617 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:28:33.608617 [info ] [MainThread]: Catalog written to C:\desafio_iplanrio\target\catalog.json
[0m13:28:33.611168 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:28:33.611168 after 3.42 seconds
[0m13:28:33.611168 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:28:33.613475 [debug] [MainThread]: Connection 'terceirizados.information_schema' was properly closed.
[0m13:28:33.613475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153126C8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015313A950A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015313A94B90>]}
[0m13:28:33.613475 [debug] [MainThread]: Flushing usage events
[0m13:28:34.967732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:41.603915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83CD9BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83B998890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83CD9B770>]}


============================== 13:28:41.622224 | 94398b00-f622-4e7c-9f39-b1b3808958a2 ==============================
[0m13:28:41.622224 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:28:41.624541 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:28:42.906854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94398b00-f622-4e7c-9f39-b1b3808958a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83C858D40>]}
[0m13:28:43.300760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94398b00-f622-4e7c-9f39-b1b3808958a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83E2C2660>]}
[0m13:31:18.695622 [error] [MainThread]: Encountered an error:

[0m13:31:18.831106 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 761, in __init__
    self.handle()
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:31:18.852388 [debug] [MainThread]: Command `dbt docs serve` failed at 13:31:18.852388 after 157.81 seconds
[0m13:31:18.858740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83C3268A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83E5711C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83C3FEC30>]}
[0m13:31:18.866722 [debug] [MainThread]: Flushing usage events
[0m13:31:20.547443 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:58.613190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A92425070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A95F67C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A95F67800>]}


============================== 13:39:58.621977 | 8dd6a642-4444-48fa-a957-512c4ae498bf ==============================
[0m13:39:58.621977 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:39:58.621977 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:39:58.629369 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.silver.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m13:39:58.631503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8dd6a642-4444-48fa-a957-512c4ae498bf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A97CBDDF0>]}
[0m13:39:59.196675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dd6a642-4444-48fa-a957-512c4ae498bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A95811850>]}
[0m13:39:59.277058 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:39:59.277058 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:39:59.277058 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:39:59.277058 [debug] [MainThread]: Command `dbt deps` succeeded at 13:39:59.277058 after 0.93 seconds
[0m13:39:59.277058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A95F67800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A96239E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A95811850>]}
[0m13:39:59.287493 [debug] [MainThread]: Flushing usage events
[0m13:40:00.224532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:07.235087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AB85D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AEEC3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AEEC3BF0>]}


============================== 13:40:07.240348 | a332e11c-6f9e-4382-8751-cb8dfb7f802c ==============================
[0m13:40:07.240348 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:40:07.240348 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m13:40:07.696764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AEAD85F0>]}
[0m13:40:07.906580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174ABAFF260>]}
[0m13:40:07.910086 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:40:08.504132 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:40:08.824177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:08.824177 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:40:08.827702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:08.902548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AEF76720>]}
[0m13:40:09.048958 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:40:09.053289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:40:09.101041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174B0859C40>]}
[0m13:40:09.101041 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m13:40:09.103050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174B079FA70>]}
[0m13:40:09.103050 [info ] [MainThread]: 
[0m13:40:09.103050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:09.103050 [info ] [MainThread]: 
[0m13:40:09.103050 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:40:09.117922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m13:40:09.491536 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m13:40:09.492995 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m13:40:09.494011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:10.718613 [debug] [ThreadPool]: SQL status: OK in 1.225 seconds
[0m13:40:10.724912 [debug] [ThreadPool]: On list_terceirizados: Close
[0m13:40:10.727414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m13:40:10.728723 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m13:40:10.740753 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:40:10.740753 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m13:40:10.740753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:10.747019 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:40:10.747591 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:40:10.747591 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m13:40:10.747591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:40:10.747591 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:40:10.747591 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m13:40:10.754782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:10.754782 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m13:40:10.754782 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m13:40:10.754782 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m13:40:10.754782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:40:10.754782 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m13:40:10.754782 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m13:40:10.775277 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m13:40:10.775277 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m13:40:10.779271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:10.781336 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:10.781817 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m13:40:10.781817 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m13:40:10.829049 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m13:40:10.833644 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m13:40:10.835644 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m13:40:10.836644 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m13:40:10.838307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174B002BA40>]}
[0m13:40:10.841667 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:10.841667 [debug] [MainThread]: On master: BEGIN
[0m13:40:10.843675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:10.846731 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:40:10.847730 [debug] [MainThread]: On master: COMMIT
[0m13:40:10.847730 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:10.848740 [debug] [MainThread]: On master: COMMIT
[0m13:40:10.850969 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:40:10.851976 [debug] [MainThread]: On master: Close
[0m13:40:10.906949 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m13:40:10.907947 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m13:40:10.909948 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m13:40:10.911834 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m13:40:10.930392 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:10.935082 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m13:40:10.992940 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:10.998423 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:10.999655 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m13:40:11.000159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:11.000159 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:11.000159 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:11.000159 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m13:40:11.179394 [debug] [Thread-1 (]: SQL status: OK in 0.174 seconds
[0m13:40:11.186876 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:11.187415 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m13:40:11.190141 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:11.193340 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:11.194411 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m13:40:11.195410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:40:11.208826 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m13:40:11.209556 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:11.209556 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m13:40:11.214881 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:40:11.219122 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m13:40:11.219122 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m13:40:11.224454 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:11.228070 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m13:40:11.228650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174B065C6B0>]}
[0m13:40:11.228650 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.32s]
[0m13:40:11.232254 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m13:40:11.232254 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m13:40:11.234575 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m13:40:11.234575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m13:40:11.234575 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m13:40:11.234575 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m13:40:11.241466 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m13:40:11.266098 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m13:40:11.268121 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m13:40:11.270130 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m13:40:11.270130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:11.270130 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:40:11.273064 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m13:40:11.273064 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m13:40:11.294397 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id" not found in FROM clause!
Candidate bindings: "Year"

LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                  ^
[0m13:40:11.295455 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m13:40:11.296726 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:40:11.297262 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m13:40:11.297262 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m13:40:11.297262 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m13:40:11.328388 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m13:40:11.328923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a332e11c-6f9e-4382-8751-cb8dfb7f802c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174B0DFF1D0>]}
[0m13:40:11.330036 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.09s]
[0m13:40:11.331033 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m13:40:11.332356 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^.
[0m13:40:11.333385 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m13:40:11.334364 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m13:40:11.335364 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m13:40:11.336363 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:11.337890 [debug] [MainThread]: On master: BEGIN
[0m13:40:11.338896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:11.340897 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:40:11.340897 [debug] [MainThread]: On master: COMMIT
[0m13:40:11.341900 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:11.342757 [debug] [MainThread]: On master: COMMIT
[0m13:40:11.345059 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:40:11.346054 [debug] [MainThread]: On master: Close
[0m13:40:11.347050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:11.348052 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m13:40:11.348562 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m13:40:11.348562 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m13:40:11.349571 [info ] [MainThread]: 
[0m13:40:11.350573 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m13:40:11.351760 [debug] [MainThread]: Command end result
[0m13:40:11.380232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m13:40:11.384746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m13:40:11.392716 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m13:40:11.392716 [info ] [MainThread]: 
[0m13:40:11.396723 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:40:11.397699 [info ] [MainThread]: 
[0m13:40:11.398703 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m13:40:11.400114 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m13:40:11.400114 [info ] [MainThread]: 
[0m13:40:11.400114 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m13:40:11.400114 [info ] [MainThread]: 
[0m13:40:11.403234 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m13:40:11.404847 [debug] [MainThread]: Command `dbt run` failed at 13:40:11.404847 after 4.34 seconds
[0m13:40:11.405844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AEED5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174AEBFA3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174B00A8FE0>]}
[0m13:40:11.405844 [debug] [MainThread]: Flushing usage events
[0m13:40:12.246903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:38.990819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB2765B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB27677A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB2764D40>]}


============================== 19:31:39.000916 | 2d95c36b-0999-49a6-b6c8-b95173b1cad0 ==============================
[0m19:31:39.000916 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:31:39.008430 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m19:31:40.656597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB3002C60>]}
[0m19:31:40.889062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB20896D0>]}
[0m19:31:40.894594 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m19:31:41.905997 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:31:42.403820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:31:42.404933 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:31:42.406052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:31:42.527390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB4508200>]}
[0m19:31:42.838944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m19:31:42.851888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m19:31:43.078053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB48B8D70>]}
[0m19:31:43.080873 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m19:31:43.085733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB471C5F0>]}
[0m19:31:43.090638 [info ] [MainThread]: 
[0m19:31:43.100608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:43.105862 [info ] [MainThread]: 
[0m19:31:43.119993 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:31:43.140431 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m19:31:43.810121 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m19:31:43.810121 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m19:31:43.812512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:45.887334 [debug] [ThreadPool]: SQL status: OK in 2.076 seconds
[0m19:31:45.891877 [debug] [ThreadPool]: On list_terceirizados: Close
[0m19:31:45.894907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m19:31:45.896858 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m19:31:45.945531 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:31:45.947061 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m19:31:45.949072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:45.951654 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:31:45.955698 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:31:45.955698 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m19:31:45.957707 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:31:45.959094 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:31:45.959094 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m19:31:45.962797 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:31:45.966510 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m19:31:45.966510 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:31:45.966510 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m19:31:45.968518 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:31:45.968518 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m19:31:45.974367 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m19:31:46.000855 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m19:31:46.000855 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m19:31:46.003149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:46.009460 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:31:46.011696 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m19:31:46.013140 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m19:31:46.080726 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m19:31:46.084285 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m19:31:46.086309 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m19:31:46.089014 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m19:31:46.093592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB44ABA10>]}
[0m19:31:46.093592 [debug] [MainThread]: Using duckdb connection "master"
[0m19:31:46.095602 [debug] [MainThread]: On master: BEGIN
[0m19:31:46.095602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:46.099361 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:31:46.100771 [debug] [MainThread]: On master: COMMIT
[0m19:31:46.100771 [debug] [MainThread]: Using duckdb connection "master"
[0m19:31:46.100771 [debug] [MainThread]: On master: COMMIT
[0m19:31:46.102792 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:31:46.102792 [debug] [MainThread]: On master: Close
[0m19:31:46.137825 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m19:31:46.139845 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m19:31:46.141594 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m19:31:46.141594 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m19:31:46.155131 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:46.184385 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m19:31:46.265686 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:46.265686 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:46.269085 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m19:31:46.269085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:31:46.271092 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:31:46.271092 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:46.274720 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m19:31:48.054782 [debug] [Thread-1 (]: SQL status: OK in 1.778 seconds
[0m19:31:48.069993 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:48.070645 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m19:31:48.074692 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:31:48.083696 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:48.084702 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m19:31:48.086063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:31:48.111031 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m19:31:48.113078 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:48.113078 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m19:31:48.118235 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:31:48.136061 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:31:48.136061 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m19:31:48.144056 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:31:48.150196 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m19:31:48.154370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AAFAB6E40>]}
[0m19:31:48.155878 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 2.01s]
[0m19:31:48.157605 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m19:31:48.159615 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m19:31:48.161919 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m19:31:48.161919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m19:31:48.164227 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m19:31:48.172677 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m19:31:48.175247 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m19:31:48.237212 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m19:31:48.315610 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m19:31:48.325536 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m19:31:48.325536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:48.325536 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:31:48.325536 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m19:31:48.325536 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m19:31:48.415817 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id" not found in FROM clause!
Candidate bindings: "Year"

LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                  ^
[0m19:31:48.416492 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m19:31:48.416492 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:31:48.418517 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m19:31:48.434343 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m19:31:48.435659 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m19:31:48.449931 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m19:31:48.451951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d95c36b-0999-49a6-b6c8-b95173b1cad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB4EBBCB0>]}
[0m19:31:48.452471 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.29s]
[0m19:31:48.455399 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m19:31:48.456426 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^.
[0m19:31:48.458963 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m19:31:48.460855 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m19:31:48.465597 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m19:31:48.468831 [debug] [MainThread]: Using duckdb connection "master"
[0m19:31:48.469457 [debug] [MainThread]: On master: BEGIN
[0m19:31:48.470196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:31:48.473600 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:31:48.475111 [debug] [MainThread]: On master: COMMIT
[0m19:31:48.475111 [debug] [MainThread]: Using duckdb connection "master"
[0m19:31:48.475111 [debug] [MainThread]: On master: COMMIT
[0m19:31:48.480478 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:31:48.480478 [debug] [MainThread]: On master: Close
[0m19:31:48.482490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:48.483999 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m19:31:48.483999 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m19:31:48.485367 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m19:31:48.485367 [info ] [MainThread]: 
[0m19:31:48.501242 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m19:31:48.503262 [debug] [MainThread]: Command end result
[0m19:31:48.561770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m19:31:48.571224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m19:31:48.587538 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m19:31:48.588350 [info ] [MainThread]: 
[0m19:31:48.589056 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:31:48.592034 [info ] [MainThread]: 
[0m19:31:48.593194 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m19:31:48.593194 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m19:31:48.595821 [info ] [MainThread]: 
[0m19:31:48.598223 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m19:31:48.599896 [info ] [MainThread]: 
[0m19:31:48.602227 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m19:31:48.608313 [debug] [MainThread]: Command `dbt run` failed at 19:31:48.607934 after 10.26 seconds
[0m19:31:48.609643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB27F9DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB2766C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AB2765B80>]}
[0m19:31:48.609643 [debug] [MainThread]: Flushing usage events
[0m19:31:50.142101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:47.216237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8275D8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F825977CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F825974EF0>]}


============================== 19:46:47.232156 | 14eb1ff7-ad74-4dd4-a865-ebef5c071e6a ==============================
[0m19:46:47.232156 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:46:47.235173 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m19:46:47.246630 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.bronze.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m19:46:47.250476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14eb1ff7-ad74-4dd4-a865-ebef5c071e6a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82771DDF0>]}
[0m19:46:48.223297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14eb1ff7-ad74-4dd4-a865-ebef5c071e6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82771DE80>]}
[0m19:46:48.458712 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:46:48.474732 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:46:48.478794 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:46:48.479939 [debug] [MainThread]: Command `dbt deps` succeeded at 19:46:48.479939 after 1.86 seconds
[0m19:46:48.483651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F825CFA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F827BF5D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F827C1A1E0>]}
[0m19:46:48.483651 [debug] [MainThread]: Flushing usage events
[0m19:46:50.440905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:03.001846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025496CC5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549A619EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025499DF4200>]}


============================== 19:47:03.009260 | 9155752a-48a2-4c20-a094-ba2aada49319 ==============================
[0m19:47:03.009260 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:47:03.011278 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m19:47:04.465336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549C3A07A0>]}
[0m19:47:04.781389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549A525CD0>]}
[0m19:47:04.789090 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m19:47:06.344875 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:47:07.184706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:07.184706 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:47:07.186697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:07.329346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549C69F920>]}
[0m19:47:07.600939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m19:47:07.606884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m19:47:07.730784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549C6AB110>]}
[0m19:47:07.732795 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m19:47:07.734607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549C8214C0>]}
[0m19:47:07.738959 [info ] [MainThread]: 
[0m19:47:07.745701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:07.746890 [info ] [MainThread]: 
[0m19:47:07.748152 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:47:07.783572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m19:47:08.159023 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m19:47:08.159023 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m19:47:08.159023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:10.015589 [debug] [ThreadPool]: SQL status: OK in 1.851 seconds
[0m19:47:10.020889 [debug] [ThreadPool]: On list_terceirizados: Close
[0m19:47:10.022825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m19:47:10.025198 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m19:47:10.039893 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:47:10.041201 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m19:47:10.041201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:10.045338 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:47:10.047744 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:47:10.048972 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m19:47:10.050066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:47:10.051233 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:47:10.052634 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m19:47:10.054816 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:47:10.058023 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m19:47:10.058527 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m19:47:10.060045 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m19:47:10.061120 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:47:10.061651 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m19:47:10.064329 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m19:47:10.079777 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m19:47:10.080784 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m19:47:10.081111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:10.083948 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:47:10.084455 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m19:47:10.084455 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m19:47:10.142773 [debug] [ThreadPool]: SQL status: OK in 0.057 seconds
[0m19:47:10.146239 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m19:47:10.148416 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m19:47:10.148416 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m19:47:10.148416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549C314200>]}
[0m19:47:10.148416 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:10.148416 [debug] [MainThread]: On master: BEGIN
[0m19:47:10.148416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:10.158061 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:47:10.159079 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.159617 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:10.160199 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.161370 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:10.162009 [debug] [MainThread]: On master: Close
[0m19:47:10.242038 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m19:47:10.243766 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m19:47:10.246012 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m19:47:10.247266 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m19:47:10.255781 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.333632 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m19:47:10.407618 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.409836 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.409836 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m19:47:10.411804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:47:10.415827 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:47:10.415827 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.418714 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m19:47:10.624204 [debug] [Thread-1 (]: SQL status: OK in 0.203 seconds
[0m19:47:10.637159 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.638398 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m19:47:10.641663 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:47:10.649806 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.650864 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m19:47:10.652697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:47:10.676096 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m19:47:10.676096 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.678525 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m19:47:10.683399 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m19:47:10.695983 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m19:47:10.695983 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m19:47:10.700338 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:47:10.706048 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m19:47:10.711646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549786F050>]}
[0m19:47:10.711646 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.46s]
[0m19:47:10.716374 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m19:47:10.718842 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m19:47:10.720914 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m19:47:10.722591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m19:47:10.723818 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m19:47:10.729698 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m19:47:10.733123 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m19:47:10.776400 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m19:47:10.778621 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m19:47:10.779686 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m19:47:10.780234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:10.782385 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:47:10.782937 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m19:47:10.784110 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m19:47:10.812378 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id" not found in FROM clause!
Candidate bindings: "Year"

LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                  ^
[0m19:47:10.812934 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m19:47:10.812934 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m19:47:10.814687 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m19:47:10.819205 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m19:47:10.820316 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m19:47:10.830224 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m19:47:10.831427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9155752a-48a2-4c20-a094-ba2aada49319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549CCABD10>]}
[0m19:47:10.832614 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.11s]
[0m19:47:10.833708 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m19:47:10.834330 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^.
[0m19:47:10.835348 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m19:47:10.838436 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m19:47:10.839090 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m19:47:10.842102 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:10.842102 [debug] [MainThread]: On master: BEGIN
[0m19:47:10.843165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:10.845889 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:47:10.846451 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.847599 [debug] [MainThread]: Using duckdb connection "master"
[0m19:47:10.848136 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.848676 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:47:10.849203 [debug] [MainThread]: On master: Close
[0m19:47:10.850270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:10.850805 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m19:47:10.851683 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m19:47:10.852391 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m19:47:10.853423 [info ] [MainThread]: 
[0m19:47:10.854553 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m19:47:10.858759 [debug] [MainThread]: Command end result
[0m19:47:10.892567 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m19:47:10.896029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m19:47:10.906635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m19:47:10.907172 [info ] [MainThread]: 
[0m19:47:10.908245 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:47:10.909308 [info ] [MainThread]: 
[0m19:47:10.910388 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m19:47:10.911477 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m19:47:10.912544 [info ] [MainThread]: 
[0m19:47:10.913641 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m19:47:10.915353 [info ] [MainThread]: 
[0m19:47:10.916457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m19:47:10.918671 [debug] [MainThread]: Command `dbt run` failed at 19:47:10.918671 after 8.20 seconds
[0m19:47:10.919776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025499E485F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025499E48CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549CB1AA20>]}
[0m19:47:10.920837 [debug] [MainThread]: Flushing usage events
[0m19:47:12.308337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:56.504830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC18094E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC18097E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC18095EB0>]}


============================== 22:17:56.537409 | d94ec087-5581-4d1b-8772-c74d919e748e ==============================
[0m22:17:56.537409 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:17:56.537409 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:18:00.399324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd94ec087-5581-4d1b-8772-c74d919e748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC19E2DB80>]}
[0m22:18:00.842118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd94ec087-5581-4d1b-8772-c74d919e748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC17C27230>]}
[0m22:18:00.866051 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:18:02.556303 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:18:03.416622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:03.420484 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:18:03.423579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:03.633529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd94ec087-5581-4d1b-8772-c74d919e748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1A07A510>]}
[0m22:18:03.820106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd94ec087-5581-4d1b-8772-c74d919e748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1A3F3CB0>]}
[0m22:18:03.821814 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m22:18:03.823880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd94ec087-5581-4d1b-8772-c74d919e748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1A0793D0>]}
[0m22:18:03.835548 [info ] [MainThread]: 
[0m22:18:03.840172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:18:03.843097 [info ] [MainThread]: 
[0m22:18:03.848839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:18:03.905567 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m22:18:04.723331 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:18:04.725441 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m22:18:04.727250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:06.988112 [debug] [ThreadPool]: SQL status: OK in 2.258 seconds
[0m22:18:06.991172 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:18:06.992667 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m22:18:07.166032 [debug] [ThreadPool]: SQL status: OK in 0.171 seconds
[0m22:18:07.178271 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m22:18:07.183151 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m22:18:07.184770 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m22:18:07.190916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd94ec087-5581-4d1b-8772-c74d919e748e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1A04C830>]}
[0m22:18:07.313864 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m22:18:07.315672 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m22:18:07.317948 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m22:18:07.358091 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:18:07.362451 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m22:18:07.365704 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m22:18:07.369015 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m22:18:07.372237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m22:18:07.373279 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m22:18:07.384902 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:18:07.388548 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m22:18:07.393014 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m22:18:07.395913 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m22:18:07.397738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m22:18:07.400255 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m22:18:07.410636 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m22:18:07.413348 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m22:18:07.415199 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m22:18:07.417857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:07.418954 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m22:18:07.419483 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m22:18:07.423829 [debug] [MainThread]: Command end result
[0m22:18:07.687360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:18:07.696824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:18:07.725546 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m22:18:07.734573 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m22:18:07.736202 [info ] [MainThread]: Building catalog
[0m22:18:07.794593 [debug] [ThreadPool]: Acquiring new duckdb connection 'terceirizados.information_schema'
[0m22:18:07.858858 [debug] [ThreadPool]: Using duckdb connection "terceirizados.information_schema"
[0m22:18:07.860028 [debug] [ThreadPool]: On terceirizados.information_schema: BEGIN
[0m22:18:07.862264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:07.869992 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m22:18:07.872218 [debug] [ThreadPool]: Using duckdb connection "terceirizados.information_schema"
[0m22:18:07.873642 [debug] [ThreadPool]: On terceirizados.information_schema: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "terceirizados.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'terceirizados'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'terceirizados'
    )
    select
        'terceirizados' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main') or upper(r.schema_name) = upper('s3_raw'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m22:18:07.937905 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m22:18:07.952003 [debug] [ThreadPool]: On terceirizados.information_schema: ROLLBACK
[0m22:18:07.954957 [debug] [ThreadPool]: Failed to rollback 'terceirizados.information_schema'
[0m22:18:07.956110 [debug] [ThreadPool]: On terceirizados.information_schema: Close
[0m22:18:07.995162 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\desafio_iplanrio\target\catalog.json
[0m22:18:08.092609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:18:08.103789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:18:08.107186 [info ] [MainThread]: Catalog written to C:\desafio_iplanrio\target\catalog.json
[0m22:18:08.115474 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:18:08.114394 after 12.64 seconds
[0m22:18:08.117538 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:18:08.118107 [debug] [MainThread]: Connection 'terceirizados.information_schema' was properly closed.
[0m22:18:08.119125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC17F7C260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC17F7E6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1A046030>]}
[0m22:18:08.119632 [debug] [MainThread]: Flushing usage events
[0m22:18:11.637518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:19.441498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8DD47560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8DD47F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8DD455E0>]}


============================== 22:18:19.448641 | ffc50ad0-dbf6-4282-9798-1e785c9e67b1 ==============================
[0m22:18:19.448641 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:18:19.448641 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:18:20.186214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc50ad0-dbf6-4282-9798-1e785c9e67b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B901A8410>]}
[0m22:18:20.376711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc50ad0-dbf6-4282-9798-1e785c9e67b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8E793EF0>]}
[0m22:47:08.897538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC13090A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABE012A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC0819520>]}


============================== 22:47:09.100869 | eb9c5855-9cf7-43ef-a21f-bfb83e769ea0 ==============================
[0m22:47:09.100869 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:47:09.100869 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:47:11.962530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC07895B0>]}
[0m22:47:12.226731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC0736000>]}
[0m22:47:12.234737 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:47:13.843798 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:47:14.497571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:14.499205 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:47:14.500299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:14.607941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC2DEC080>]}
[0m22:47:14.720240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:47:14.724084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:47:14.919732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC31095E0>]}
[0m22:47:14.928209 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m22:47:14.936369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC2F77590>]}
[0m22:47:14.947710 [info ] [MainThread]: 
[0m22:47:14.951582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:47:14.953675 [info ] [MainThread]: 
[0m22:47:14.958676 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:47:15.021285 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m22:47:16.038736 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m22:47:16.040748 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m22:47:16.040748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:18.541984 [debug] [ThreadPool]: SQL status: OK in 2.500 seconds
[0m22:47:18.551161 [debug] [ThreadPool]: On list_terceirizados: Close
[0m22:47:18.554760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m22:47:18.556098 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m22:47:18.580183 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:47:18.580183 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m22:47:18.581783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:47:18.586802 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:47:18.590582 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:47:18.592955 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m22:47:18.594128 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:47:18.595743 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:47:18.596392 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m22:47:18.600064 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:47:18.603461 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:47:18.604895 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:47:18.604895 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:47:18.607676 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:47:18.608361 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m22:47:18.627448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m22:47:18.651786 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:47:18.651786 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m22:47:18.657392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:18.658427 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m22:47:18.658427 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:47:18.658427 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m22:47:18.811138 [debug] [ThreadPool]: SQL status: OK in 0.144 seconds
[0m22:47:18.819069 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m22:47:18.826808 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m22:47:18.829107 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m22:47:18.847921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC2B7B920>]}
[0m22:47:18.849896 [debug] [MainThread]: Using duckdb connection "master"
[0m22:47:18.851944 [debug] [MainThread]: On master: BEGIN
[0m22:47:18.855275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:18.859986 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m22:47:18.863273 [debug] [MainThread]: On master: COMMIT
[0m22:47:18.871202 [debug] [MainThread]: Using duckdb connection "master"
[0m22:47:18.875220 [debug] [MainThread]: On master: COMMIT
[0m22:47:18.880506 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:47:18.882518 [debug] [MainThread]: On master: Close
[0m22:47:18.979381 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m22:47:18.980382 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m22:47:18.987991 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m22:47:18.989480 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m22:47:19.032777 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:19.049989 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m22:47:19.174955 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:19.179314 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:19.179314 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m22:47:19.179314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:19.189510 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:47:19.190518 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:19.193970 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m22:47:20.619244 [debug] [Thread-1 (]: SQL status: OK in 1.421 seconds
[0m22:47:20.638844 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:20.641028 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m22:47:20.665942 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m22:47:20.677322 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:20.678879 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m22:47:20.683317 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:47:20.723714 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:47:20.725221 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:20.725221 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:47:20.735638 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m22:47:20.757033 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:47:20.758151 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m22:47:20.762811 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:47:20.770437 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m22:47:20.776436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC26E75F0>]}
[0m22:47:20.781958 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 1.79s]
[0m22:47:20.781958 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m22:47:20.812733 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m22:47:20.813741 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m22:47:20.814742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m22:47:20.815748 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m22:47:20.826911 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:47:20.831507 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m22:47:20.911612 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:47:20.922176 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:47:20.923184 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m22:47:20.923184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:20.930364 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:47:20.933177 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:47:20.933177 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m22:47:21.099526 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id" not found in FROM clause!
Candidate bindings: "Year"

LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                  ^
[0m22:47:21.102092 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Chave Prim√°ria
    CAST(id AS STRING) AS id_terceirizado,
    
    -- Usando INITCAP do pr√≥prio DuckDB para formatar nomes
    INITCAP(nome) AS terceirizado_nome,
    INITCAP(orgao_superior) AS orgao_superior_nome,
    UPPER(sigla_orgao) AS orgao_superior_sigla,
    
    -- Documentos
    cnpj_empresa AS empresa_cnpj,
    cpf AS cpf,
    
    -- Valores e Datas
    CAST(valor_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(data_inicio AS DATE) AS contrato_inicio_data,
    
    -- Metadados e Parti√ß√£o
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m22:47:21.103451 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:47:21.104756 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m22:47:21.119261 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m22:47:21.120736 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m22:47:21.140510 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m22:47:21.144242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9c5855-9cf7-43ef-a21f-bfb83e769ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC358B140>]}
[0m22:47:21.146935 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.33s]
[0m22:47:21.153797 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m22:47:21.154849 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^.
[0m22:47:21.160699 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m22:47:21.166679 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m22:47:21.169006 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m22:47:21.171033 [debug] [MainThread]: Using duckdb connection "master"
[0m22:47:21.172334 [debug] [MainThread]: On master: BEGIN
[0m22:47:21.173346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:21.178505 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m22:47:21.178980 [debug] [MainThread]: On master: COMMIT
[0m22:47:21.180917 [debug] [MainThread]: Using duckdb connection "master"
[0m22:47:21.181573 [debug] [MainThread]: On master: COMMIT
[0m22:47:21.184174 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:47:21.185606 [debug] [MainThread]: On master: Close
[0m22:47:21.186620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:21.188777 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m22:47:21.188777 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m22:47:21.190855 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m22:47:21.201007 [info ] [MainThread]: 
[0m22:47:21.202989 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m22:47:21.206914 [debug] [MainThread]: Command end result
[0m22:47:21.330333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:47:21.348231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:47:21.376522 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m22:47:21.377275 [info ] [MainThread]: 
[0m22:47:21.381332 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:47:21.382316 [info ] [MainThread]: 
[0m22:47:21.384892 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m22:47:21.384892 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id" not found in FROM clause!
  Candidate bindings: "Year"
  
  LINE 19:     CAST(id AS STRING) AS id_terceirizado,
                    ^
[0m22:47:21.384892 [info ] [MainThread]: 
[0m22:47:21.384892 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m22:47:21.384892 [info ] [MainThread]: 
[0m22:47:21.384892 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m22:47:21.384892 [debug] [MainThread]: Command `dbt run` failed at 22:47:21.384892 after 13.66 seconds
[0m22:47:21.384892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC1183530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC12ECA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAC12EE480>]}
[0m22:47:21.384892 [debug] [MainThread]: Flushing usage events
[0m22:47:23.551189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:50:23.076812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014471FC4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014475709DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014475C0B0B0>]}


============================== 22:50:23.084576 | 42393d89-d4e0-49a1-ae68-4d635e044929 ==============================
[0m22:50:23.084576 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:50:23.087155 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:50:23.812238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144774A09E0>]}
[0m22:50:23.932011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014476F5B860>]}
[0m22:50:23.935133 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:50:24.480709 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:50:24.719465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:50:24.719465 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m22:50:25.177903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014477C279E0>]}
[0m22:50:25.300472 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:50:25.305551 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:50:25.354510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144778F9F10>]}
[0m22:50:25.356519 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m22:50:25.356519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014477968C80>]}
[0m22:50:25.360982 [info ] [MainThread]: 
[0m22:50:25.360982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:50:25.362489 [info ] [MainThread]: 
[0m22:50:25.362489 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:50:25.372992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m22:50:25.606749 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m22:50:25.607749 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m22:50:25.609497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:26.697472 [debug] [ThreadPool]: SQL status: OK in 1.088 seconds
[0m22:50:26.697472 [debug] [ThreadPool]: On list_terceirizados: Close
[0m22:50:26.701366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m22:50:26.701366 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m22:50:26.776889 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:50:26.776889 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m22:50:26.776889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:26.779591 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:50:26.779591 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:50:26.779591 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m22:50:26.779591 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:26.779591 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:50:26.786120 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m22:50:26.786120 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:50:26.788794 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:50:26.788794 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:50:26.789799 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:50:26.789799 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:50:26.789799 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m22:50:26.792739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m22:50:26.800302 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:50:26.800302 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m22:50:26.800302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:26.802830 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:50:26.802830 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:50:26.802830 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m22:50:26.841540 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m22:50:26.841540 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m22:50:26.846193 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m22:50:26.846193 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m22:50:26.846193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014477C61250>]}
[0m22:50:26.846193 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:26.846193 [debug] [MainThread]: On master: BEGIN
[0m22:50:26.846193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:50:26.851864 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:50:26.851864 [debug] [MainThread]: On master: COMMIT
[0m22:50:26.851864 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:26.851864 [debug] [MainThread]: On master: COMMIT
[0m22:50:26.851864 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:50:26.855691 [debug] [MainThread]: On master: Close
[0m22:50:26.882910 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m22:50:26.887517 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m22:50:26.887517 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m22:50:26.887517 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m22:50:26.893370 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:26.897810 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m22:50:26.939015 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:26.943429 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:26.943429 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m22:50:26.943429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:26.948232 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:26.949237 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:26.949237 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m22:50:27.119416 [debug] [Thread-1 (]: SQL status: OK in 0.169 seconds
[0m22:50:27.129717 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:27.130810 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m22:50:27.133909 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:27.138070 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:27.139070 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m22:50:27.140072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:27.156159 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:50:27.157158 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:27.158173 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:50:27.163826 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:50:27.163826 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:50:27.163826 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m22:50:27.176299 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:50:27.176299 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m22:50:27.184373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144778EB5F0>]}
[0m22:50:27.184373 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.29s]
[0m22:50:27.186506 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m22:50:27.186506 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m22:50:27.186506 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m22:50:27.186506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m22:50:27.191580 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m22:50:27.216194 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.216194 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m22:50:27.219283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:27.221311 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:27.221311 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.221311 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'terceirizados_bronze'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'terceirizados'
      
      order by ordinal_position

  
[0m22:50:27.228943 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m22:50:27.237003 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.237003 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m22:50:27.268029 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.270035 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.271036 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Criamos um ID baseado na linha para evitar o erro de coluna ausente
    CAST(row_number() OVER () AS STRING) AS id_terceirizado,
    
    -- Usamos colunas gen√©ricas para o teste n√£o travar
    'Colaborador Teste' AS terceirizado_nome,
    'Orgao Teste' AS orgao_superior_nome,
    'IPLAN' AS orgao_superior_sigla,
    
    -- Documentos fict√≠cios
    '00.000.000/0001-00' AS empresa_cnpj,
    '000.000.000-00' AS cpf,
    
    -- Se for o arquivo de teste (PIB), tentamos pegar a coluna 'Value', sen√£o 0
    
    
        CAST("Value" AS DECIMAL(18,2)) AS salario_valor,
    

    CAST('2025-01-01' AS DATE) AS contrato_inicio_data,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m22:50:27.340225 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m22:50:27.346390 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.346896 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m22:50:27.348906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:27.359139 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:50:27.360575 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.360575 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:50:27.371014 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:50:27.375774 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:50:27.375774 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m22:50:27.375774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:27.381537 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m22:50:27.383049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144776E7860>]}
[0m22:50:27.384685 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.20s]
[0m22:50:27.385758 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m22:50:27.386809 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m22:50:27.387899 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m22:50:27.389077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m22:50:27.389780 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m22:50:27.396461 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m22:50:27.399456 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m22:50:27.407511 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m22:50:27.410278 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:50:27.412230 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m22:50:27.415236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:27.417246 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:50:27.418247 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:50:27.418247 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    -- 1. Chave prim√°ria
    id_terceirizado,
    
    -- 2. Atributos principais
    terceirizado_nome,
    cpf,
    salario_valor,
    contrato_inicio_data,
    
    -- 3. Chaves estrangeiras e descri√ß√µes
    orgao_superior_sigla,
    orgao_superior_nome,
    empresa_cnpj,
    
    -- 4. Metadados de processamento
    CURRENT_TIMESTAMP AS data_carga_datahora,
    
    -- 5. Colunas de parti√ß√£o ao final
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m22:50:27.439803 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m22:50:27.450857 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:50:27.450857 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m22:50:27.450857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:50:27.450857 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:50:27.450857 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:50:27.456871 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:50:27.465164 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m22:50:27.468685 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:50:27.468685 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m22:50:27.469687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:50:27.471691 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m22:50:27.472691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42393d89-d4e0-49a1-ae68-4d635e044929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144776E76E0>]}
[0m22:50:27.472691 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.08s]
[0m22:50:27.474677 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m22:50:27.475678 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:27.476680 [debug] [MainThread]: On master: BEGIN
[0m22:50:27.478182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:50:27.480483 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:50:27.481491 [debug] [MainThread]: On master: COMMIT
[0m22:50:27.481491 [debug] [MainThread]: Using duckdb connection "master"
[0m22:50:27.482492 [debug] [MainThread]: On master: COMMIT
[0m22:50:27.483494 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:50:27.484492 [debug] [MainThread]: On master: Close
[0m22:50:27.485491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:27.485491 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m22:50:27.486493 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m22:50:27.486493 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m22:50:27.487801 [info ] [MainThread]: 
[0m22:50:27.488808 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m22:50:27.490828 [debug] [MainThread]: Command end result
[0m22:50:27.519445 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:50:27.523998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:50:27.537116 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m22:50:27.537116 [info ] [MainThread]: 
[0m22:50:27.539596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:50:27.540602 [info ] [MainThread]: 
[0m22:50:27.540602 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:50:27.542677 [debug] [MainThread]: Command `dbt run` succeeded at 22:50:27.540602 after 5.14 seconds
[0m22:50:27.542677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014477FCE750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014477FCE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014477BFC8C0>]}
[0m22:50:27.542677 [debug] [MainThread]: Flushing usage events
[0m22:50:28.823502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:55.587854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B570D83EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B570D831A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B570D83FB0>]}


============================== 22:52:55.596576 | 4e9043de-cd87-41db-9e8c-2a3a3985ccc2 ==============================
[0m22:52:55.596576 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:52:55.596576 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:52:56.310617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572B18680>]}
[0m22:52:56.398596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57109B0B0>]}
[0m22:52:56.399161 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:52:56.733093 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:52:56.888250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:52:56.888250 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:52:56.888250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:52:56.939191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5706B7200>]}
[0m22:52:57.014260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:52:57.016143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:52:57.088844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5730296D0>]}
[0m22:52:57.088844 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m22:52:57.088844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572D0EC60>]}
[0m22:52:57.088844 [info ] [MainThread]: 
[0m22:52:57.094919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:57.094919 [info ] [MainThread]: 
[0m22:52:57.094919 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:52:57.099034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m22:52:57.301330 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m22:52:57.301330 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m22:52:57.301330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:58.325683 [debug] [ThreadPool]: SQL status: OK in 1.026 seconds
[0m22:52:58.329401 [debug] [ThreadPool]: On list_terceirizados: Close
[0m22:52:58.329401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m22:52:58.329401 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m22:52:58.339495 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:52:58.339495 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m22:52:58.339495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:58.345060 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m22:52:58.345060 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:52:58.347068 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m22:52:58.347068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:52:58.347068 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:52:58.347068 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m22:52:58.349580 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:52:58.349580 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:52:58.349580 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:52:58.349580 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:52:58.349580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:52:58.349580 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m22:52:58.349580 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m22:52:58.362926 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:52:58.363460 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m22:52:58.363989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:58.365567 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:52:58.365567 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:52:58.366111 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m22:52:58.395689 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m22:52:58.398177 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m22:52:58.400323 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m22:52:58.400845 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m22:52:58.402422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56E22F470>]}
[0m22:52:58.402960 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:58.403568 [debug] [MainThread]: On master: BEGIN
[0m22:52:58.403568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:58.405167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:52:58.405698 [debug] [MainThread]: On master: COMMIT
[0m22:52:58.405698 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:58.406228 [debug] [MainThread]: On master: COMMIT
[0m22:52:58.406782 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:52:58.407315 [debug] [MainThread]: On master: Close
[0m22:52:58.438193 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m22:52:58.439426 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m22:52:58.439426 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m22:52:58.439426 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m22:52:58.448450 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.451312 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m22:52:58.506488 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.510088 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.511248 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m22:52:58.511248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:58.514406 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:52:58.515914 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.516922 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m22:52:58.678862 [debug] [Thread-1 (]: SQL status: OK in 0.162 seconds
[0m22:52:58.686582 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.687101 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m22:52:58.689249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.692883 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.693592 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m22:52:58.693592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.706285 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:52:58.707285 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.708298 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:52:58.711813 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:52:58.718745 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:52:58.718745 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m22:52:58.721907 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:52:58.724463 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m22:52:58.727982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572A4CB60>]}
[0m22:52:58.727982 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.29s]
[0m22:52:58.728981 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m22:52:58.729988 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m22:52:58.731357 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m22:52:58.731357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m22:52:58.732358 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m22:52:58.742354 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.743381 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m22:52:58.744364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:52:58.746411 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:52:58.746411 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.747515 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'terceirizados_bronze'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'terceirizados'
      
      order by ordinal_position

  
[0m22:52:58.761066 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m22:52:58.766070 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.766070 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m22:52:58.792818 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.793331 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.793331 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Criamos um ID baseado na linha para evitar o erro de coluna ausente
    CAST(row_number() OVER () AS STRING) AS id_terceirizado,
    
    -- Usamos colunas gen√©ricas para o teste n√£o travar
    'Colaborador Teste' AS terceirizado_nome,
    'Orgao Teste' AS orgao_superior_nome,
    'IPLAN' AS orgao_superior_sigla,
    
    -- Documentos fict√≠cios
    '00.000.000/0001-00' AS empresa_cnpj,
    '000.000.000-00' AS cpf,
    
    -- Se for o arquivo de teste (PIB), tentamos pegar a coluna 'Value', sen√£o 0
    
    
        CAST("Value" AS DECIMAL(18,2)) AS salario_valor,
    

    CAST('2025-01-01' AS DATE) AS contrato_inicio_data,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m22:52:58.857683 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m22:52:58.863438 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.864034 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m22:52:58.865121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.867150 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.867150 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m22:52:58.869662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:52:58.873565 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.873565 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados" rename to "stg_terceirizados__dbt_backup"
[0m22:52:58.873565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:52:58.877419 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.878455 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m22:52:58.879351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:52:58.884457 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:52:58.884457 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.885425 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:52:58.892188 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m22:52:58.895673 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:52:58.895673 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m22:52:58.895673 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:52:58.895673 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m22:52:58.895673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57336B1A0>]}
[0m22:52:58.895673 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.16s]
[0m22:52:58.895673 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m22:52:58.895673 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m22:52:58.895673 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m22:52:58.906220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m22:52:58.906866 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m22:52:58.907895 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m22:52:58.907895 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m22:52:58.907895 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m22:52:58.907895 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.916655 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m22:52:58.916655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:52:58.916655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.916655 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.916655 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    -- 1. Chave prim√°ria
    id_terceirizado,
    
    -- 2. Atributos principais
    terceirizado_nome,
    cpf,
    salario_valor,
    contrato_inicio_data,
    
    -- 3. Chaves estrangeiras e descri√ß√µes
    orgao_superior_sigla,
    orgao_superior_nome,
    empresa_cnpj,
    
    -- 4. Metadados de processamento
    CURRENT_TIMESTAMP AS data_carga_datahora,
    
    -- 5. Colunas de parti√ß√£o ao final
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m22:52:58.933588 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m22:52:58.935583 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.935583 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m22:52:58.936615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.937660 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.938850 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m22:52:58.940462 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.943543 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.943543 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados" rename to "terceirizados__dbt_backup"
[0m22:52:58.943543 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:52:58.947750 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.947750 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m22:52:58.952618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:52:58.952618 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:52:58.954628 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.954628 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:52:58.960234 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m22:52:58.967310 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:52:58.967310 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m22:52:58.968818 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:52:58.970931 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m22:52:58.970931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e9043de-cd87-41db-9e8c-2a3a3985ccc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57098FBC0>]}
[0m22:52:58.970931 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.06s]
[0m22:52:58.972937 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m22:52:58.974688 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:58.975287 [debug] [MainThread]: On master: BEGIN
[0m22:52:58.975755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:58.976497 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:52:58.976497 [debug] [MainThread]: On master: COMMIT
[0m22:52:58.979042 [debug] [MainThread]: Using duckdb connection "master"
[0m22:52:58.979042 [debug] [MainThread]: On master: COMMIT
[0m22:52:58.979042 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:52:58.979042 [debug] [MainThread]: On master: Close
[0m22:52:58.979042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:58.979042 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m22:52:58.979042 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m22:52:58.979042 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m22:52:58.979042 [info ] [MainThread]: 
[0m22:52:58.979042 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m22:52:58.979042 [debug] [MainThread]: Command end result
[0m22:52:59.069602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:52:59.072606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:52:59.081150 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m22:52:59.082159 [info ] [MainThread]: 
[0m22:52:59.083160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:52:59.083160 [info ] [MainThread]: 
[0m22:52:59.084431 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:52:59.086523 [debug] [MainThread]: Command `dbt run` succeeded at 22:52:59.085465 after 3.84 seconds
[0m22:52:59.086523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B570896D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572F65700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B572F643B0>]}
[0m22:52:59.087511 [debug] [MainThread]: Flushing usage events
[0m22:53:00.135331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:30.101820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CB7336D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBA057D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBA057DA0>]}


============================== 22:53:30.105633 | baea0fcf-421c-4f39-ae4e-29cf9d2e21ac ==============================
[0m22:53:30.105633 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:53:30.105633 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:53:30.400833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBA9476B0>]}
[0m22:53:30.489929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CB99BB4D0>]}
[0m22:53:30.491936 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:53:30.748796 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:53:30.848855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:30.848855 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:53:30.848855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:30.897650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBC02C7A0>]}
[0m22:53:30.963497 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:53:30.963497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:53:30.982329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBC1CA4B0>]}
[0m22:53:30.982329 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m22:53:30.982329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBC346CC0>]}
[0m22:53:30.982329 [info ] [MainThread]: 
[0m22:53:30.982329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:53:30.982329 [info ] [MainThread]: 
[0m22:53:30.982329 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:53:30.999872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m22:53:31.071110 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m22:53:31.072111 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m22:53:31.072111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:31.193581 [debug] [ThreadPool]: SQL status: OK in 0.122 seconds
[0m22:53:31.195585 [debug] [ThreadPool]: On list_terceirizados: Close
[0m22:53:31.195585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m22:53:31.195585 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m22:53:31.202205 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:31.202205 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m22:53:31.202205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:31.202205 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:53:31.202205 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:31.202205 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m22:53:31.202205 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:31.202205 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:31.202205 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m22:53:31.202205 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:31.202205 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:53:31.202205 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:31.202205 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:53:31.211927 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:31.211927 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m22:53:31.211927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m22:53:31.218088 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:53:31.222115 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m22:53:31.222115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:31.222115 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:53:31.222115 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:53:31.222115 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m22:53:31.234999 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m22:53:31.234999 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m22:53:31.234999 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m22:53:31.242524 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m22:53:31.242524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBBDBBB00>]}
[0m22:53:31.242524 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:31.242524 [debug] [MainThread]: On master: BEGIN
[0m22:53:31.242524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:31.246245 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:31.246245 [debug] [MainThread]: On master: COMMIT
[0m22:53:31.246245 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:31.248254 [debug] [MainThread]: On master: COMMIT
[0m22:53:31.248254 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:31.248254 [debug] [MainThread]: On master: Close
[0m22:53:31.249832 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:31.252977 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m22:53:31.252977 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m22:53:31.252977 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:31.252977 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.252977 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:31.296272 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.297274 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.298254 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m22:53:31.298254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:31.300252 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.300252 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.301253 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m22:53:31.338545 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m22:53:31.346671 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.347194 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m22:53:31.348259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:31.351424 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.351424 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m22:53:31.352443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:31.365299 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:53:31.365299 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.366283 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:53:31.368967 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.376677 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:31.376677 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m22:53:31.376677 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.376677 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m22:53:31.376677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CB747B2C0>]}
[0m22:53:31.387884 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.12s]
[0m22:53:31.387884 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:31.387884 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m22:53:31.391106 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m22:53:31.393118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m22:53:31.393118 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m22:53:31.406181 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.406705 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m22:53:31.407293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:31.409550 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.410147 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.410693 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'terceirizados_bronze'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'terceirizados'
      
      order by ordinal_position

  
[0m22:53:31.416700 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m22:53:31.420223 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.421220 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m22:53:31.449358 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.449358 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.449358 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Criamos um ID baseado na linha para evitar o erro de coluna ausente
    CAST(row_number() OVER () AS STRING) AS id_terceirizado,
    
    -- Usamos colunas gen√©ricas para o teste n√£o travar
    'Colaborador Teste' AS terceirizado_nome,
    'Orgao Teste' AS orgao_superior_nome,
    'IPLAN' AS orgao_superior_sigla,
    
    -- Documentos fict√≠cios
    '00.000.000/0001-00' AS empresa_cnpj,
    '000.000.000-00' AS cpf,
    
    -- Se for o arquivo de teste (PIB), tentamos pegar a coluna 'Value', sen√£o 0
    
    
        CAST("Value" AS DECIMAL(18,2)) AS salario_valor,
    

    CAST('2025-01-01' AS DATE) AS contrato_inicio_data,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m22:53:31.492462 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m22:53:31.499300 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.499300 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m22:53:31.500813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.501823 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.502824 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m22:53:31.504003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.507579 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.507579 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados" rename to "stg_terceirizados__dbt_backup"
[0m22:53:31.509052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.512168 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.513168 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m22:53:31.514170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:31.519171 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:53:31.519171 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.520170 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:53:31.527617 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:53:31.530598 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:31.530598 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m22:53:31.533119 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.534630 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m22:53:31.535642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBC647B00>]}
[0m22:53:31.536644 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.14s]
[0m22:53:31.536644 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m22:53:31.537639 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m22:53:31.538638 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m22:53:31.538638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m22:53:31.539639 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m22:53:31.542652 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m22:53:31.542652 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m22:53:31.545291 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m22:53:31.548374 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.548374 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m22:53:31.548374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:31.548374 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.548374 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.548374 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    -- 1. Chave prim√°ria
    id_terceirizado,
    
    -- 2. Atributos principais
    terceirizado_nome,
    cpf,
    salario_valor,
    contrato_inicio_data,
    
    -- 3. Chaves estrangeiras e descri√ß√µes
    orgao_superior_sigla,
    orgao_superior_nome,
    empresa_cnpj,
    
    -- 4. Metadados de processamento
    CURRENT_TIMESTAMP AS data_carga_datahora,
    
    -- 5. Colunas de parti√ß√£o ao final
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m22:53:31.574274 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m22:53:31.576275 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.577277 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m22:53:31.579546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.581546 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.581546 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m22:53:31.584444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.584959 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.584959 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados" rename to "terceirizados__dbt_backup"
[0m22:53:31.592698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.599978 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.599978 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m22:53:31.599978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:31.599978 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:53:31.605428 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.605428 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:53:31.616692 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m22:53:31.620687 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:31.620687 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m22:53:31.623690 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:31.625791 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m22:53:31.626320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baea0fcf-421c-4f39-ae4e-29cf9d2e21ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBC6E8D70>]}
[0m22:53:31.627433 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.09s]
[0m22:53:31.628434 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m22:53:31.629433 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:31.630438 [debug] [MainThread]: On master: BEGIN
[0m22:53:31.630438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:31.632429 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:53:31.632429 [debug] [MainThread]: On master: COMMIT
[0m22:53:31.633430 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:31.633430 [debug] [MainThread]: On master: COMMIT
[0m22:53:31.633430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:31.633430 [debug] [MainThread]: On master: Close
[0m22:53:31.634937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:31.634937 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m22:53:31.634937 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m22:53:31.635945 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m22:53:31.636451 [info ] [MainThread]: 
[0m22:53:31.636451 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m22:53:31.637462 [debug] [MainThread]: Command end result
[0m22:53:31.723330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:53:31.726597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:53:31.733124 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m22:53:31.734126 [info ] [MainThread]: 
[0m22:53:31.734126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:31.735119 [info ] [MainThread]: 
[0m22:53:31.735119 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:53:31.736233 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:31.736233 after 1.81 seconds
[0m22:53:31.737234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CBA946EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CB99F3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011CB75E4C20>]}
[0m22:53:31.737234 [debug] [MainThread]: Flushing usage events
[0m22:53:32.626121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:46.087088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157289BBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157289A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021572898EC0>]}


============================== 22:53:46.090285 | da8c835c-2ab6-4be6-b744-b36b76eae650 ==============================
[0m22:53:46.090285 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:53:46.090285 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m22:53:46.439649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215728D9100>]}
[0m22:53:46.555530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021570FDC530>]}
[0m22:53:46.560092 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:53:46.977330 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:53:47.118428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:47.119557 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:53:47.119557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:47.167243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021573FABD40>]}
[0m22:53:47.266021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:53:47.266021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:53:47.286640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215741CADE0>]}
[0m22:53:47.286640 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m22:53:47.286640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157423CC80>]}
[0m22:53:47.294098 [info ] [MainThread]: 
[0m22:53:47.295097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:53:47.296097 [info ] [MainThread]: 
[0m22:53:47.297097 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:53:47.303236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m22:53:47.369310 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m22:53:47.369310 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m22:53:47.369310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:47.506608 [debug] [ThreadPool]: SQL status: OK in 0.134 seconds
[0m22:53:47.506608 [debug] [ThreadPool]: On list_terceirizados: Close
[0m22:53:47.512698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m22:53:47.512698 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m22:53:47.520457 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:47.520457 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m22:53:47.520457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:47.520457 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:53:47.520457 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:47.520457 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m22:53:47.520457 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:47.527181 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:47.527181 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m22:53:47.527181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:47.527181 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:53:47.527181 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m22:53:47.527181 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m22:53:47.527181 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:47.527181 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m22:53:47.527181 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m22:53:47.539460 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:53:47.539460 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m22:53:47.539460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:47.539460 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:53:47.539460 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m22:53:47.539460 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m22:53:47.558454 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m22:53:47.560664 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m22:53:47.562266 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m22:53:47.563266 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m22:53:47.565250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021573DBB9E0>]}
[0m22:53:47.565250 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:47.566253 [debug] [MainThread]: On master: BEGIN
[0m22:53:47.566253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:47.567250 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:47.567250 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.568757 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:47.568757 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.568757 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:47.569765 [debug] [MainThread]: On master: Close
[0m22:53:47.572764 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:47.573766 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m22:53:47.574765 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m22:53:47.574765 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:47.581943 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.581943 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:47.616818 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.618826 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.618826 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m22:53:47.618826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:47.620833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:47.622906 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.622906 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usamos o IP 127.0.0.1 que √© mais est√°vel que 'localhost' no Windows
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m22:53:47.643916 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m22:53:47.650798 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.651331 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m22:53:47.652396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:47.655123 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.656150 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m22:53:47.657134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.670662 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:53:47.671664 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.672353 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m22:53:47.675139 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:47.680699 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m22:53:47.681695 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m22:53:47.683733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.685733 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m22:53:47.687734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021573D6CE90>]}
[0m22:53:47.688736 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.11s]
[0m22:53:47.689733 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m22:53:47.690733 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m22:53:47.691297 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m22:53:47.691888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m22:53:47.693010 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m22:53:47.703522 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.705132 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m22:53:47.705132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:47.706737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:47.708499 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.708499 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'terceirizados_bronze'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'terceirizados'
      
      order by ordinal_position

  
[0m22:53:47.712522 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:53:47.719834 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.720800 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m22:53:47.742476 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.745740 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.745740 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Criamos um ID baseado na linha para evitar o erro de coluna ausente
    CAST(row_number() OVER () AS STRING) AS id_terceirizado,
    
    -- Usamos colunas gen√©ricas para o teste n√£o travar
    'Colaborador Teste' AS terceirizado_nome,
    'Orgao Teste' AS orgao_superior_nome,
    'IPLAN' AS orgao_superior_sigla,
    
    -- Documentos fict√≠cios
    '00.000.000/0001-00' AS empresa_cnpj,
    '000.000.000-00' AS cpf,
    
    -- Se for o arquivo de teste (PIB), tentamos pegar a coluna 'Value', sen√£o 0
    
    
        CAST("Value" AS DECIMAL(18,2)) AS salario_valor,
    

    CAST('2025-01-01' AS DATE) AS contrato_inicio_data,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m22:53:47.791723 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m22:53:47.796731 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.797732 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m22:53:47.798238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.800246 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.800246 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m22:53:47.801245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.804896 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.805895 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados" rename to "stg_terceirizados__dbt_backup"
[0m22:53:47.806879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:47.809987 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.809987 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m22:53:47.810985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.815982 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:53:47.816982 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.816982 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m22:53:47.824001 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m22:53:47.826997 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m22:53:47.826997 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m22:53:47.830535 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:47.831537 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m22:53:47.832535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215747B8A10>]}
[0m22:53:47.832535 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.14s]
[0m22:53:47.833536 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m22:53:47.834534 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m22:53:47.835535 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m22:53:47.836532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m22:53:47.836532 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m22:53:47.839069 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m22:53:47.840100 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m22:53:47.844920 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m22:53:47.845920 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.845920 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m22:53:47.846917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:47.847919 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:47.847919 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.849492 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    -- 1. Chave prim√°ria
    id_terceirizado,
    
    -- 2. Atributos principais
    terceirizado_nome,
    cpf,
    salario_valor,
    contrato_inicio_data,
    
    -- 3. Chaves estrangeiras e descri√ß√µes
    orgao_superior_sigla,
    orgao_superior_nome,
    empresa_cnpj,
    
    -- 4. Metadados de processamento
    CURRENT_TIMESTAMP AS data_carga_datahora,
    
    -- 5. Colunas de parti√ß√£o ao final
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m22:53:47.860564 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:53:47.862599 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.862599 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m22:53:47.864653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.864653 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.867893 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m22:53:47.867893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.869903 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.869903 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados" rename to "terceirizados__dbt_backup"
[0m22:53:47.869903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:47.877855 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.879981 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m22:53:47.881002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:47.883001 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:53:47.883001 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.884002 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m22:53:47.890904 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:53:47.894681 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m22:53:47.895683 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m22:53:47.897680 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:53:47.899682 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m22:53:47.900302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8c835c-2ab6-4be6-b744-b36b76eae650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215746E8890>]}
[0m22:53:47.901338 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.06s]
[0m22:53:47.901338 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m22:53:47.905526 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:47.905526 [debug] [MainThread]: On master: BEGIN
[0m22:53:47.905526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:47.905526 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m22:53:47.905526 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.908647 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:47.909236 [debug] [MainThread]: On master: COMMIT
[0m22:53:47.910244 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:47.911066 [debug] [MainThread]: On master: Close
[0m22:53:47.911575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:47.912671 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m22:53:47.912671 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m22:53:47.912671 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m22:53:47.913668 [info ] [MainThread]: 
[0m22:53:47.914583 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m22:53:47.915583 [debug] [MainThread]: Command end result
[0m22:53:47.994332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m22:53:47.996454 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m22:53:48.002423 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m22:53:48.003374 [info ] [MainThread]: 
[0m22:53:48.003374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:48.003374 [info ] [MainThread]: 
[0m22:53:48.004914 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:53:48.005922 [debug] [MainThread]: Command `dbt run` succeeded at 22:53:48.005922 after 2.10 seconds
[0m22:53:48.006504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215725AF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156BFD4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215723C2030>]}
[0m22:53:48.006504 [debug] [MainThread]: Flushing usage events
[0m22:53:48.864854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:16.890103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9FFF26A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E982D24F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E982D27140>]}


============================== 23:17:16.900042 | 96193ad8-e90b-4824-94d7-dbfcd381047b ==============================
[0m23:17:16.900042 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:17:16.901051 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:17:18.011084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9800D7BF0>]}
[0m23:17:18.229850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984B18B60>]}
[0m23:17:18.234370 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:17:18.978366 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:17:19.435342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:17:19.438882 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\gold\terceirizados.sql
[0m23:17:19.440712 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\bronze\terceirizados_bronze.sql
[0m23:17:19.444115 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m23:17:20.277126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9850E0830>]}
[0m23:17:20.375539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:17:20.378848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:17:20.429058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984FE1F40>]}
[0m23:17:20.436248 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:17:20.436248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E985066C60>]}
[0m23:17:20.438270 [info ] [MainThread]: 
[0m23:17:20.438270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:20.438270 [info ] [MainThread]: 
[0m23:17:20.438270 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:17:20.447786 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:17:20.761441 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:17:20.761441 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:17:20.768553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:21.864935 [debug] [ThreadPool]: SQL status: OK in 1.097 seconds
[0m23:17:21.866959 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:17:21.868970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:17:21.869980 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:17:21.879348 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:17:21.879348 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:17:21.879348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:21.879348 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:17:21.879348 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:17:21.879348 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:17:21.879348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:17:21.879348 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:17:21.879348 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:17:21.886361 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:17:21.886361 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:17:21.886361 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:17:21.886361 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:17:21.886361 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:17:21.886361 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:17:21.892047 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:17:21.965030 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:17:21.965705 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:17:21.965705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:21.968704 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:17:21.968704 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:17:21.968704 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:17:21.999310 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m23:17:21.999310 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:17:21.999310 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:17:21.999310 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:17:21.999310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9850B17F0>]}
[0m23:17:21.999310 [debug] [MainThread]: Using duckdb connection "master"
[0m23:17:21.999310 [debug] [MainThread]: On master: BEGIN
[0m23:17:21.999310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:22.009819 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:17:22.009819 [debug] [MainThread]: On master: COMMIT
[0m23:17:22.009819 [debug] [MainThread]: Using duckdb connection "master"
[0m23:17:22.009819 [debug] [MainThread]: On master: COMMIT
[0m23:17:22.011900 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:17:22.011900 [debug] [MainThread]: On master: Close
[0m23:17:22.028904 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:17:22.030445 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:17:22.031968 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:17:22.031968 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:17:22.031968 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.066365 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:17:22.110965 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.124199 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.124199 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:17:22.126310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:17:22.129412 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:17:22.130431 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.130431 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- O DuckDB l√™ o arquivo Parquet que seu rob√¥ salvou no S3 falso
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m23:17:22.310758 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m23:17:22.318236 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.318773 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m23:17:22.321445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:17:22.324017 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.325017 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m23:17:22.325845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:17:22.339283 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:17:22.340290 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.340974 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:17:22.346267 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:17:22.352799 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:17:22.352799 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m23:17:22.356372 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:17:22.358381 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:17:22.362039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E984AE3620>]}
[0m23:17:22.363129 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.33s]
[0m23:17:22.364048 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:17:22.365046 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:17:22.366047 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m23:17:22.366047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m23:17:22.367047 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m23:17:22.369046 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:17:22.371629 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m23:17:22.395636 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:17:22.395636 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:17:22.395636 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m23:17:22.395636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:22.402713 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:17:22.402713 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:17:22.402713 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento das colunas reais da sua planilha
    CAST(id_terc AS STRING) AS id_terceirizado,
    INITCAP(nm_terceirizado) AS terceirizado_nome,
    UPPER(sg_orgao_sup) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal AS DECIMAL(18,2)) AS salario_valor,
    
    -- Metadados exigidos
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m23:17:22.445809 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id_terc" not found in FROM clause!
Candidate bindings: "Country Name"

LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                  ^
[0m23:17:22.446874 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento das colunas reais da sua planilha
    CAST(id_terc AS STRING) AS id_terceirizado,
    INITCAP(nm_terceirizado) AS terceirizado_nome,
    UPPER(sg_orgao_sup) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal AS DECIMAL(18,2)) AS salario_valor,
    
    -- Metadados exigidos
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m23:17:22.446874 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:17:22.447419 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m23:17:22.451127 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m23:17:22.451685 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m23:17:22.459561 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id_terc" not found in FROM clause!
  Candidate bindings: "Country Name"
  
  LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                    ^
[0m23:17:22.459561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96193ad8-e90b-4824-94d7-dbfcd381047b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9854FFAA0>]}
[0m23:17:22.460587 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.09s]
[0m23:17:22.461568 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:17:22.462590 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id_terc" not found in FROM clause!
  Candidate bindings: "Country Name"
  
  LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                    ^.
[0m23:17:22.463577 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:17:22.464588 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:17:22.464588 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:17:22.466567 [debug] [MainThread]: Using duckdb connection "master"
[0m23:17:22.467094 [debug] [MainThread]: On master: BEGIN
[0m23:17:22.467094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:17:22.468111 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:17:22.469097 [debug] [MainThread]: On master: COMMIT
[0m23:17:22.469097 [debug] [MainThread]: Using duckdb connection "master"
[0m23:17:22.469097 [debug] [MainThread]: On master: COMMIT
[0m23:17:22.470601 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:17:22.470601 [debug] [MainThread]: On master: Close
[0m23:17:22.470601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:22.471624 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:17:22.471624 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:17:22.471624 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m23:17:22.472622 [info ] [MainThread]: 
[0m23:17:22.472622 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m23:17:22.474831 [debug] [MainThread]: Command end result
[0m23:17:22.499665 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:17:22.502425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:17:22.508118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:17:22.508118 [info ] [MainThread]: 
[0m23:17:22.508118 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:17:22.511039 [info ] [MainThread]: 
[0m23:17:22.511589 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m23:17:22.513756 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id_terc" not found in FROM clause!
  Candidate bindings: "Country Name"
  
  LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                    ^
[0m23:17:22.513756 [info ] [MainThread]: 
[0m23:17:22.513756 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m23:17:22.513756 [info ] [MainThread]: 
[0m23:17:22.513756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m23:17:22.518481 [debug] [MainThread]: Command `dbt run` failed at 23:17:22.518481 after 6.11 seconds
[0m23:17:22.518481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9831B1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9829AD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9851E5160>]}
[0m23:17:22.518481 [debug] [MainThread]: Flushing usage events
[0m23:17:23.760315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:23.779492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4874980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C6FCEB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C7A32060>]}


============================== 23:25:23.794668 | 38bdd6bd-812d-4a6a-ab02-f1003e756370 ==============================
[0m23:25:23.794668 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:25:23.796197 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:25:23.806017 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.bronze.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m23:25:23.808041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38bdd6bd-812d-4a6a-ab02-f1003e756370', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C8610CE0>]}
[0m23:25:25.020915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38bdd6bd-812d-4a6a-ab02-f1003e756370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C81868D0>]}
[0m23:25:25.130302 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:25:25.139004 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:25:25.140176 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:25:25.141320 [debug] [MainThread]: Command `dbt deps` succeeded at 23:25:25.141320 after 1.97 seconds
[0m23:25:25.144138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C85983E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C828F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C828D4C0>]}
[0m23:25:25.147653 [debug] [MainThread]: Flushing usage events
[0m23:25:27.143860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:43.350777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48D038B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48C7B20C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48D039040>]}


============================== 23:25:43.360092 | ab10ee1b-0dcc-4960-b6fc-a58f4f5280ed ==============================
[0m23:25:43.360092 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:25:43.362100 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:25:44.489990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab10ee1b-0dcc-4960-b6fc-a58f4f5280ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B489B63D10>]}
[0m23:25:44.784345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab10ee1b-0dcc-4960-b6fc-a58f4f5280ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48E6123C0>]}
[0m23:25:44.798481 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:25:46.212835 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:25:46.792757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:25:46.796783 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m23:25:48.136339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab10ee1b-0dcc-4960-b6fc-a58f4f5280ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48ECA3D10>]}
[0m23:25:48.409274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:25:48.417607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:25:48.541583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab10ee1b-0dcc-4960-b6fc-a58f4f5280ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48E93DD30>]}
[0m23:25:48.545193 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:25:48.547235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab10ee1b-0dcc-4960-b6fc-a58f4f5280ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48EC6CD70>]}
[0m23:25:48.557995 [info ] [MainThread]: 
[0m23:25:48.560011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:25:48.564048 [info ] [MainThread]: 
[0m23:25:48.566081 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:25:48.600023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:25:49.180371 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:25:49.180371 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:25:49.180371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:49.294830 [debug] [ThreadPool]: DuckDB adapter: duckdb error: IO Error: Cannot open file "c:\desafio_iplanrio\data\terceirizados.duckdb": O sistema n√£o pode encontrar o caminho especificado.

[0m23:25:49.299526 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:25:49.299526 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:25:49.305153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:49.350898 [debug] [ThreadPool]: DuckDB adapter: duckdb error: IO Error: Cannot open file "c:\desafio_iplanrio\data\terceirizados.duckdb": O sistema n√£o pode encontrar o caminho especificado.

[0m23:25:49.351659 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: macro list_schemas
[0m23:25:49.352819 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:25:49.354828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:49.379026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:49.382340 [debug] [MainThread]: Connection 'list_terceirizados' was properly closed.
[0m23:25:49.384091 [info ] [MainThread]: 
[0m23:25:49.384091 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m23:25:49.384091 [error] [MainThread]: Encountered an error:
IO Error: Cannot open file "c:\desafio_iplanrio\data\terceirizados.duckdb": O sistema n√£o pode encontrar o caminho especificado.

[0m23:25:49.607892 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 95, in exception_handler
    yield
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\sql\connections.py", line 147, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\contracts\connection.py", line 96, in handle
    self._handle.resolve(self)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\contracts\connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\environments\local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\environments\__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\desafio_iplanrio\data\terceirizados.duckdb": O sistema n√£o pode encontrar o caminho especificado.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 95, in exception_handler
    yield
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\impl.py", line 1320, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\clients\jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 20, in macro
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\record.py", line 538, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\impl.py", line 471, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 130, in execute
    return super().execute(sql, auto_begin, fetch, limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\sql\connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\sql\connections.py", line 131, in add_query
    with self.exception_handler(sql):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 102, in exception_handler
    self.rollback_if_open()
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\contracts\connection.py", line 96, in handle
    self._handle.resolve(self)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\contracts\connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\environments\local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\environments\__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\desafio_iplanrio\data\terceirizados.duckdb": O sistema n√£o pode encontrar o caminho especificado.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 408, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 587, in run
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 626, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 559, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\run.py", line 1117, in before_run
    self.create_schemas(adapter, required_schemas)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 734, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
                                    ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\utils\executor.py", line 16, in connected
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 709, in list_schemas
    for s in adapter.list_schemas(database_quoted)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\sql\impl.py", line 218, in list_schemas
    results = self.execute_macro(LIST_SCHEMAS_MACRO_NAME, kwargs={"database": database})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\impl.py", line 1319, in execute_macro
    with self.connections.exception_handler(f"macro {macro_name}"):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 102, in exception_handler
    self.rollback_if_open()
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\contracts\connection.py", line 96, in handle
    self._handle.resolve(self)
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\contracts\connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\environments\local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\duckdb\environments\__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_duckdb.IOException: IO Error: Cannot open file "c:\desafio_iplanrio\data\terceirizados.duckdb": O sistema n√£o pode encontrar o caminho especificado.


[0m23:25:49.625684 [debug] [MainThread]: Command `dbt run` failed at 23:25:49.623599 after 6.61 seconds
[0m23:25:49.627688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48C7B20C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48EC6FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48EBBA3F0>]}
[0m23:25:49.630304 [debug] [MainThread]: Flushing usage events
[0m23:25:51.617049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:32.803466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019756016960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975908A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019759003E30>]}


============================== 23:29:32.821592 | af613f8a-5543-4420-8303-3ceac4b2259f ==============================
[0m23:29:32.821592 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:29:32.824478 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:29:34.774848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019758732840>]}
[0m23:29:35.123078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019758D77FB0>]}
[0m23:29:35.130122 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:29:36.314045 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:29:36.859528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:36.860542 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m23:29:37.959369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B247B60>]}
[0m23:29:38.063061 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:29:38.064003 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:29:38.116787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975AF1E630>]}
[0m23:29:38.116787 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:29:38.116787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975AD337A0>]}
[0m23:29:38.118793 [info ] [MainThread]: 
[0m23:29:38.121301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:38.121301 [info ] [MainThread]: 
[0m23:29:38.121301 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:29:38.131719 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:29:38.307707 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:29:38.307707 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:29:38.307707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:39.460782 [debug] [ThreadPool]: SQL status: OK in 1.156 seconds
[0m23:29:39.460782 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:29:39.460782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:29:39.460782 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:29:39.547418 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:29:39.547418 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:29:39.549425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:39.552577 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:29:39.553598 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:29:39.553598 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:29:39.553598 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:29:39.553598 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:29:39.553598 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:29:39.560587 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m23:29:39.562594 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:29:39.564102 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:29:39.564102 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:29:39.564102 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:29:39.566664 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:29:39.568663 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:29:39.574345 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:29:39.576461 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:29:39.576461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:39.578467 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:29:39.578467 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:29:39.578467 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:29:39.605580 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m23:29:39.605580 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:29:39.605580 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:29:39.605580 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:29:39.614709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B61B0B0>]}
[0m23:29:39.615746 [debug] [MainThread]: Using duckdb connection "master"
[0m23:29:39.615746 [debug] [MainThread]: On master: BEGIN
[0m23:29:39.615746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:39.615746 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:29:39.615746 [debug] [MainThread]: On master: COMMIT
[0m23:29:39.615746 [debug] [MainThread]: Using duckdb connection "master"
[0m23:29:39.615746 [debug] [MainThread]: On master: COMMIT
[0m23:29:39.615746 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:29:39.615746 [debug] [MainThread]: On master: Close
[0m23:29:39.647516 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:29:39.647516 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:29:39.647516 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:29:39.647516 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:29:39.667614 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.671363 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:29:39.705469 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.722960 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.725611 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:29:39.727858 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:29:39.732416 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:29:39.732416 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.732416 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- O DuckDB l√™ o arquivo Parquet que seu rob√¥ salvou no S3 falso
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m23:29:39.862667 [debug] [Thread-1 (]: SQL status: OK in 0.128 seconds
[0m23:29:39.871520 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.872049 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m23:29:39.874607 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:29:39.887375 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:29:39.887375 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.887375 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:29:39.893371 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:29:39.900989 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:29:39.900989 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m23:29:39.904233 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:29:39.908478 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:29:39.909495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975AC6E210>]}
[0m23:29:39.909495 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.26s]
[0m23:29:39.909495 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:29:39.913190 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:29:39.913190 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m23:29:39.915797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m23:29:39.915797 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m23:29:39.932329 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:39.932329 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m23:29:39.933842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:39.933842 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:29:39.935942 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:39.935942 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'terceirizados_bronze'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'terceirizados'
      
      order by ordinal_position

  
[0m23:29:39.945164 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m23:29:39.955237 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:39.955237 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m23:29:39.988583 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:39.993912 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:39.996422 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Se n√£o achar 'id_terc', gera um ID autom√°tico para voc√™ conseguir testar
    
    
        CAST(row_number() OVER () AS STRING) AS id_terceirizado,
    

    'Colaborador Teste' AS terceirizado_nome,
    'IPLAN' AS orgao_superior_sigla,
    '31.546.484/0001-00' AS empresa_cnpj,
    '000.000.000-00' AS cpf,
    5000.00 AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m23:29:40.034160 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m23:29:40.038968 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:40.039563 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m23:29:40.041344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:29:40.043614 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m23:29:40.048499 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:40.048499 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m23:29:40.056536 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:29:40.059014 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:29:40.059014 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m23:29:40.059014 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:29:40.059014 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m23:29:40.059014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B637290>]}
[0m23:29:40.059014 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.15s]
[0m23:29:40.064657 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:29:40.064657 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:29:40.064657 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m23:29:40.064657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m23:29:40.064657 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m23:29:40.071121 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m23:29:40.072817 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m23:29:40.072817 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m23:29:40.072817 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:29:40.080005 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m23:29:40.080641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:40.081161 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:29:40.081161 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:29:40.081161 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    id_terceirizado,
    terceirizado_nome,
    cpf,
    salario_valor,
    orgao_superior_sigla,
    empresa_cnpj,
    CURRENT_TIMESTAMP AS data_carga_datahora,
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m23:29:40.103097 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m23:29:40.107442 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:29:40.107442 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m23:29:40.112164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:29:40.114386 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m23:29:40.116386 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:29:40.116386 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m23:29:40.125614 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m23:29:40.133074 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:29:40.133074 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m23:29:40.133074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:29:40.136156 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m23:29:40.137202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af613f8a-5543-4420-8303-3ceac4b2259f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B262AB0>]}
[0m23:29:40.137202 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.07s]
[0m23:29:40.137202 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:29:40.137202 [debug] [MainThread]: Using duckdb connection "master"
[0m23:29:40.137202 [debug] [MainThread]: On master: BEGIN
[0m23:29:40.137202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:40.144397 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:29:40.144397 [debug] [MainThread]: On master: COMMIT
[0m23:29:40.144397 [debug] [MainThread]: Using duckdb connection "master"
[0m23:29:40.144397 [debug] [MainThread]: On master: COMMIT
[0m23:29:40.144397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:29:40.144397 [debug] [MainThread]: On master: Close
[0m23:29:40.144397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:40.144397 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:29:40.144397 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:29:40.149006 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m23:29:40.149695 [info ] [MainThread]: 
[0m23:29:40.150254 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m23:29:40.153497 [debug] [MainThread]: Command end result
[0m23:29:40.195494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:29:40.198527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:29:40.206154 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:29:40.206154 [info ] [MainThread]: 
[0m23:29:40.214976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:40.214976 [info ] [MainThread]: 
[0m23:29:40.216324 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:29:40.216324 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:40.216324 after 7.94 seconds
[0m23:29:40.216324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975914AAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019758D394F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197591E8890>]}
[0m23:29:40.216324 [debug] [MainThread]: Flushing usage events
[0m23:29:41.501105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:47.721929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AD7CAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AC1F8E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AC9B3620>]}


============================== 23:32:47.738780 | dfe92701-c3ad-419c-958a-6edf4f240e22 ==============================
[0m23:32:47.738780 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:32:47.740789 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:32:48.692533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AD841940>]}
[0m23:32:48.828812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AEC6D610>]}
[0m23:32:48.839309 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:32:49.324678 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:32:49.536062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:49.538138 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:32:49.538138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:49.582015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AF04C260>]}
[0m23:32:49.675804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:32:49.680011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:32:49.731559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AF10D3D0>]}
[0m23:32:49.731559 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:32:49.731559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AF227C50>]}
[0m23:32:49.737015 [info ] [MainThread]: 
[0m23:32:49.739025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:49.739025 [info ] [MainThread]: 
[0m23:32:49.739025 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:32:49.742036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:32:49.994278 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:32:49.994278 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:32:49.994278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:51.260282 [debug] [ThreadPool]: SQL status: OK in 1.265 seconds
[0m23:32:51.261723 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:32:51.263800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:32:51.263800 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:32:51.271829 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:32:51.271829 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:32:51.274401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:51.275126 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:32:51.275126 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:32:51.275126 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:32:51.275126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:32:51.275126 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:32:51.275126 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:32:51.282514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:32:51.282514 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:32:51.282514 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:32:51.284586 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:32:51.284586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:32:51.284586 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:32:51.286594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:32:51.292672 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:32:51.292672 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:32:51.292672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:51.292672 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:32:51.301957 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:32:51.302966 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:32:51.338530 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m23:32:51.338530 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:32:51.344143 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:32:51.344143 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:32:51.346070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AA3F35C0>]}
[0m23:32:51.346070 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:51.348080 [debug] [MainThread]: On master: BEGIN
[0m23:32:51.348080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:51.348080 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:32:51.348080 [debug] [MainThread]: On master: COMMIT
[0m23:32:51.348080 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:51.348080 [debug] [MainThread]: On master: COMMIT
[0m23:32:51.348080 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:32:51.348080 [debug] [MainThread]: On master: Close
[0m23:32:51.392388 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:32:51.394405 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:32:51.395915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:32:51.395915 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:32:51.409730 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.427337 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:32:51.476377 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.479943 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.482444 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:32:51.482444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:51.484453 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:32:51.486468 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.486468 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- O DuckDB l√™ o arquivo Parquet que seu rob√¥ salvou no S3 falso
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m23:32:51.692014 [debug] [Thread-1 (]: SQL status: OK in 0.204 seconds
[0m23:32:51.704601 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.704601 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m23:32:51.708131 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:32:51.712210 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.712210 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m23:32:51.712210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:51.731299 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:32:51.731299 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.731299 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:32:51.736278 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:32:51.739355 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:32:51.739355 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m23:32:51.748604 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:32:51.751851 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:32:51.751851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AF63BFE0>]}
[0m23:32:51.751851 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.36s]
[0m23:32:51.751851 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:32:51.761038 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:32:51.761038 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m23:32:51.764239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m23:32:51.765413 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m23:32:51.793129 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.793129 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m23:32:51.793129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:51.799538 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:32:51.801953 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.803857 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'terceirizados_bronze'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'terceirizados'
      
      order by ordinal_position

  
[0m23:32:51.813994 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m23:32:51.824303 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.825479 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m23:32:51.857934 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.865550 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.865550 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Se n√£o achar 'id_terc', gera um ID autom√°tico para voc√™ conseguir testar
    
    
        CAST(row_number() OVER () AS STRING) AS id_terceirizado,
    

    'Colaborador Teste' AS terceirizado_nome,
    'IPLAN' AS orgao_superior_sigla,
    '31.546.484/0001-00' AS empresa_cnpj,
    '000.000.000-00' AS cpf,
    5000.00 AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m23:32:51.907904 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m23:32:51.912915 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.912915 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m23:32:51.917001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:51.920358 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.920358 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_terceirizados'
  
[0m23:32:51.924391 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:32:51.929437 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.931444 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados" rename to "stg_terceirizados__dbt_backup"
[0m23:32:51.933452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:51.937980 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.940093 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m23:32:51.940093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:32:51.948278 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m23:32:51.948278 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.948278 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m23:32:51.959296 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m23:32:51.964905 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:32:51.964905 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m23:32:51.964905 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:32:51.969030 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m23:32:51.971153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AF575C70>]}
[0m23:32:51.971153 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.21s]
[0m23:32:51.971153 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:32:51.974112 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:32:51.974756 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m23:32:51.974756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m23:32:51.974756 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m23:32:51.979574 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m23:32:51.979574 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m23:32:51.979574 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m23:32:51.979574 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:51.979574 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m23:32:51.979574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:51.979574 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:32:51.990268 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:51.991181 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    id_terceirizado,
    terceirizado_nome,
    cpf,
    salario_valor,
    orgao_superior_sigla,
    empresa_cnpj,
    CURRENT_TIMESTAMP AS data_carga_datahora,
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m23:32:52.015592 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m23:32:52.021375 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:52.022424 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m23:32:52.024854 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:32:52.026861 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:52.026861 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'terceirizados'
  
[0m23:32:52.026861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:52.026861 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:52.033202 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados" rename to "terceirizados__dbt_backup"
[0m23:32:52.033854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:52.037073 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:52.037073 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m23:32:52.037073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:32:52.046564 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m23:32:52.046564 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:52.046564 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m23:32:52.060766 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m23:32:52.064634 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m23:32:52.064634 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m23:32:52.068436 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:32:52.069561 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m23:32:52.071571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe92701-c3ad-419c-958a-6edf4f240e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AF586F00>]}
[0m23:32:52.071571 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.09s]
[0m23:32:52.073620 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:32:52.075194 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:52.075194 [debug] [MainThread]: On master: BEGIN
[0m23:32:52.076424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:52.078873 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:32:52.080156 [debug] [MainThread]: On master: COMMIT
[0m23:32:52.080156 [debug] [MainThread]: Using duckdb connection "master"
[0m23:32:52.080156 [debug] [MainThread]: On master: COMMIT
[0m23:32:52.080156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:32:52.080156 [debug] [MainThread]: On master: Close
[0m23:32:52.080156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:52.080156 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:32:52.080156 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:32:52.086209 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m23:32:52.087472 [info ] [MainThread]: 
[0m23:32:52.087472 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m23:32:52.090996 [debug] [MainThread]: Command end result
[0m23:32:52.203110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:32:52.212324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:32:52.221304 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:32:52.221304 [info ] [MainThread]: 
[0m23:32:52.221304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:52.221304 [info ] [MainThread]: 
[0m23:32:52.224374 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:32:52.224374 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:52.224374 after 4.93 seconds
[0m23:32:52.226382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172ACC021B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172AA4761B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172ACB06240>]}
[0m23:32:52.226382 [debug] [MainThread]: Flushing usage events
[0m23:32:53.604210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:50.250363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028909FF4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890D1418B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890D895340>]}


============================== 23:37:50.261942 | 790da943-cd0d-4c1c-8b0b-f33d8477963a ==============================
[0m23:37:50.261942 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:37:50.263908 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:37:51.277639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890DD39010>]}
[0m23:37:51.413985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890F0738C0>]}
[0m23:37:51.419229 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:37:52.078584 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:37:52.307666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:52.308220 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m23:37:52.831690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890FCCFFB0>]}
[0m23:37:52.929395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:37:52.934215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:37:52.986377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890FCF8D40>]}
[0m23:37:52.987899 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:37:52.987899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890F7A6B40>]}
[0m23:37:52.987899 [info ] [MainThread]: 
[0m23:37:52.987899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:52.987899 [info ] [MainThread]: 
[0m23:37:52.987899 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:37:53.001665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:37:53.338834 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:37:53.339386 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:37:53.339931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:54.613204 [debug] [ThreadPool]: SQL status: OK in 1.273 seconds
[0m23:37:54.617285 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:37:54.618902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:37:54.620534 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:37:54.635761 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:37:54.636782 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:37:54.636782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:54.640519 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:37:54.642680 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:37:54.642680 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:37:54.643780 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:54.644381 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:37:54.644381 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:37:54.647193 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:54.648199 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:37:54.649363 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:37:54.649363 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:37:54.649363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:37:54.651373 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:37:54.652145 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:37:54.735376 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:37:54.735949 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:37:54.735949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:54.738759 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:37:54.739302 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:37:54.739302 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:37:54.772695 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m23:37:54.775130 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:37:54.779242 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:37:54.780058 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:37:54.781638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890F55B9B0>]}
[0m23:37:54.782764 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:54.783356 [debug] [MainThread]: On master: BEGIN
[0m23:37:54.783897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:54.786612 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:37:54.787144 [debug] [MainThread]: On master: COMMIT
[0m23:37:54.787702 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:54.788806 [debug] [MainThread]: On master: COMMIT
[0m23:37:54.789902 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:54.790457 [debug] [MainThread]: On master: Close
[0m23:37:54.799273 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:37:54.800338 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:37:54.801935 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:37:54.802473 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:37:54.814847 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:54.817371 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:37:54.882479 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:54.884634 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:54.885731 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:37:54.886324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:54.892949 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:37:54.893456 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:54.894565 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- O DuckDB l√™ o arquivo Parquet que seu rob√¥ salvou no S3 falso
SELECT * FROM read_parquet('http://127.0.0.1:4566/iplanrio-bucket/raw/terceirizados_2025-01.parquet')
  );

[0m23:37:54.995186 [debug] [Thread-1 (]: SQL status: OK in 0.099 seconds
[0m23:37:55.005387 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:55.006764 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m23:37:55.010011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:37:55.025343 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:37:55.025900 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:55.026451 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m23:37:55.032239 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:37:55.040059 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:37:55.040595 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m23:37:55.042915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:37:55.045662 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:37:55.048423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890FB04C80>]}
[0m23:37:55.050285 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.24s]
[0m23:37:55.051350 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:37:55.052413 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:37:55.053493 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m23:37:55.054569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m23:37:55.055293 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m23:37:55.059035 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:37:55.060626 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m23:37:55.098711 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m23:37:55.102724 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:37:55.103364 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m23:37:55.103364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:55.106978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:37:55.106978 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m23:37:55.109129 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento exato das colunas das suas planilhas CSV/XLSX
    CAST(id_terc AS STRING) AS id_terceirizado,
    INITCAP(nm_terceirizado) AS terceirizado_nome,
    UPPER(sg_orgao_sup) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal AS DECIMAL(18,2)) AS salario_valor,
    -- Identificador do m√™s para a idempot√™ncia exigida no desafio
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m23:37:55.140468 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "id_terc" not found in FROM clause!
Candidate bindings: "Country Name"

LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                  ^
[0m23:37:55.141033 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento exato das colunas das suas planilhas CSV/XLSX
    CAST(id_terc AS STRING) AS id_terceirizado,
    INITCAP(nm_terceirizado) AS terceirizado_nome,
    UPPER(sg_orgao_sup) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal AS DECIMAL(18,2)) AS salario_valor,
    -- Identificador do m√™s para a idempot√™ncia exigida no desafio
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m23:37:55.142243 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:37:55.142797 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m23:37:55.147449 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m23:37:55.148090 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m23:37:55.157412 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id_terc" not found in FROM clause!
  Candidate bindings: "Country Name"
  
  LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                    ^
[0m23:37:55.158532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790da943-cd0d-4c1c-8b0b-f33d8477963a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890F94DD60>]}
[0m23:37:55.159116 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.10s]
[0m23:37:55.160216 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:37:55.161312 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id_terc" not found in FROM clause!
  Candidate bindings: "Country Name"
  
  LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                    ^.
[0m23:37:55.163184 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:37:55.163715 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:37:55.165510 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:37:55.168148 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:55.169058 [debug] [MainThread]: On master: BEGIN
[0m23:37:55.169854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:55.172660 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:37:55.173200 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.174558 [debug] [MainThread]: Using duckdb connection "master"
[0m23:37:55.175126 [debug] [MainThread]: On master: COMMIT
[0m23:37:55.176244 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:37:55.176803 [debug] [MainThread]: On master: Close
[0m23:37:55.177352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:55.177863 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:37:55.178374 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:37:55.178999 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m23:37:55.180215 [info ] [MainThread]: 
[0m23:37:55.182070 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m23:37:55.184682 [debug] [MainThread]: Command end result
[0m23:37:55.234404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:37:55.240591 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:37:55.249433 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:37:55.253060 [info ] [MainThread]: 
[0m23:37:55.254171 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:37:55.254883 [info ] [MainThread]: 
[0m23:37:55.256342 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m23:37:55.256925 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Binder Error: Referenced column "id_terc" not found in FROM clause!
  Candidate bindings: "Country Name"
  
  LINE 19:     CAST(id_terc AS STRING) AS id_terceirizado,
                    ^
[0m23:37:55.258072 [info ] [MainThread]: 
[0m23:37:55.259184 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m23:37:55.260384 [info ] [MainThread]: 
[0m23:37:55.261062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m23:37:55.263357 [debug] [MainThread]: Command `dbt run` failed at 23:37:55.262817 after 5.62 seconds
[0m23:37:55.263888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028909FF4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890D5C7EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002890D1B8890>]}
[0m23:37:55.265489 [debug] [MainThread]: Flushing usage events
[0m23:37:56.603768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:47.717392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7D356900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0030A840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A00215190>]}


============================== 23:41:47.727409 | 31c8c4ff-311f-48a0-855b-8b5041602be5 ==============================
[0m23:41:47.727409 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:41:47.729579 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:41:48.947196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7D4A3B90>]}
[0m23:41:49.127880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A01C08500>]}
[0m23:41:49.135208 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:41:50.308735 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:41:50.579805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:41:50.581812 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\bronze\terceirizados_bronze.sql
[0m23:41:50.581812 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m23:41:51.199560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A023F68D0>]}
[0m23:41:51.310364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:41:51.316020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:41:51.372610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0233E360>]}
[0m23:41:51.372610 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:41:51.372610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0266FCE0>]}
[0m23:41:51.382987 [info ] [MainThread]: 
[0m23:41:51.387808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:51.390011 [info ] [MainThread]: 
[0m23:41:51.390614 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:41:51.404672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:41:51.664153 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:41:51.664153 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:41:51.666235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:53.108628 [debug] [ThreadPool]: SQL status: OK in 1.442 seconds
[0m23:41:53.112313 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:41:53.114321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:41:53.117745 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:41:53.133646 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:41:53.137206 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:41:53.137206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:53.141997 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:41:53.141997 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:41:53.141997 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:41:53.141997 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:53.146512 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:41:53.147021 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:41:53.149042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:41:53.150558 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:41:53.150558 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:41:53.151607 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:41:53.152649 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:53.152649 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:41:53.154850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:41:53.253753 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:41:53.253753 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:41:53.253753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:53.259932 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:41:53.259932 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:41:53.262864 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:41:53.308004 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m23:41:53.311538 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:41:53.311918 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:41:53.314869 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:41:53.316379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0269FB60>]}
[0m23:41:53.318411 [debug] [MainThread]: Using duckdb connection "master"
[0m23:41:53.318411 [debug] [MainThread]: On master: BEGIN
[0m23:41:53.318411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:53.321954 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:41:53.321954 [debug] [MainThread]: On master: COMMIT
[0m23:41:53.324717 [debug] [MainThread]: Using duckdb connection "master"
[0m23:41:53.324717 [debug] [MainThread]: On master: COMMIT
[0m23:41:53.326730 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:41:53.326730 [debug] [MainThread]: On master: Close
[0m23:41:53.347301 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:41:53.349445 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:41:53.349445 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:41:53.351457 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:41:53.365879 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:41:53.369353 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:41:53.432581 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:41:53.432581 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:41:53.437736 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:41:53.437736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:53.443087 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:41:53.444110 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:41:53.445626 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Substitua pelo caminho real onde est√£o os seus CSVs baixados
SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados202501.xlsx - Planilha1.csv')
  );

[0m23:41:53.461955 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados202501.xlsx - Planilha1.csv"

LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados202501.xlsx...
                      ^
[0m23:41:53.463110 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Substitua pelo caminho real onde est√£o os seus CSVs baixados
SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados202501.xlsx - Planilha1.csv')
  );

[0m23:41:53.466639 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:41:53.467728 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m23:41:53.474787 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:41:53.477237 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:41:53.487908 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados202501.xlsx - Planilha1.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados202501.xlsx...
                        ^
[0m23:41:53.491947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c8c4ff-311f-48a0-855b-8b5041602be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A025340E0>]}
[0m23:41:53.493975 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 0.14s]
[0m23:41:53.495486 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:41:53.497488 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados202501.xlsx - Planilha1.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados202501.xlsx...
                        ^.
[0m23:41:53.499650 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:41:53.500715 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.stg_terceirizados .................................... [[33mSKIP[0m]
[0m23:41:53.501779 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:41:53.503594 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:41:53.504964 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:41:53.506709 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:41:53.508670 [debug] [MainThread]: Using duckdb connection "master"
[0m23:41:53.509494 [debug] [MainThread]: On master: BEGIN
[0m23:41:53.509494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:53.514187 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:41:53.515010 [debug] [MainThread]: On master: COMMIT
[0m23:41:53.515654 [debug] [MainThread]: Using duckdb connection "master"
[0m23:41:53.516173 [debug] [MainThread]: On master: COMMIT
[0m23:41:53.517398 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:41:53.518457 [debug] [MainThread]: On master: Close
[0m23:41:53.519950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:53.522228 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:41:53.523286 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:41:53.524508 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m23:41:53.525647 [info ] [MainThread]: 
[0m23:41:53.526764 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m23:41:53.529586 [debug] [MainThread]: Command end result
[0m23:41:53.583121 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:41:53.587754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:41:53.597164 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:41:53.598561 [info ] [MainThread]: 
[0m23:41:53.601534 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:41:53.601534 [info ] [MainThread]: 
[0m23:41:53.601534 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m23:41:53.601534 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados202501.xlsx - Planilha1.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados202501.xlsx...
                        ^
[0m23:41:53.601534 [info ] [MainThread]: 
[0m23:41:53.601534 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m23:41:53.601534 [info ] [MainThread]: 
[0m23:41:53.601534 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m23:41:53.609335 [debug] [MainThread]: Command `dbt run` failed at 23:41:53.609335 after 6.96 seconds
[0m23:41:53.609335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7FA78B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7FA78440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A00AC6630>]}
[0m23:41:53.609335 [debug] [MainThread]: Flushing usage events
[0m23:41:55.196126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:18.217815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE077B6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE09F46A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0A5BA930>]}


============================== 23:45:18.231176 | 0c049ac0-36b6-4475-921b-7f66851f35c1 ==============================
[0m23:45:18.231176 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:45:18.233638 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:45:19.519208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE098D17F0>]}
[0m23:45:19.710637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE07B2F230>]}
[0m23:45:19.712157 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:45:20.496528 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:45:20.886895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:45:20.888918 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m23:45:20.891784 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\bronze\terceirizados_bronze.sql
[0m23:45:22.324511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C876510>]}
[0m23:45:22.644099 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:45:22.653435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:45:22.801800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C9F9190>]}
[0m23:45:22.801800 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:45:22.803817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C9B4050>]}
[0m23:45:22.815329 [info ] [MainThread]: 
[0m23:45:22.815329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:22.819903 [info ] [MainThread]: 
[0m23:45:22.822695 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:45:22.843702 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:45:23.536227 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:45:23.536227 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:45:23.539234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:26.019457 [debug] [ThreadPool]: SQL status: OK in 2.479 seconds
[0m23:45:26.025359 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:45:26.025359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:45:26.030686 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:45:26.068436 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:45:26.068436 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:45:26.068436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:26.078331 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m23:45:26.088728 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:45:26.090777 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:45:26.094381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:26.096708 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:45:26.098595 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:45:26.102674 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:45:26.108006 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:45:26.108878 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:45:26.111817 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:45:26.115107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:26.117917 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:45:26.122345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:45:26.278742 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:45:26.278742 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:45:26.284248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:26.287599 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m23:45:26.287599 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:45:26.294154 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:45:26.380286 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m23:45:26.385267 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:45:26.390282 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:45:26.392041 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:45:26.394795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0BF1BC20>]}
[0m23:45:26.397352 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:26.399170 [debug] [MainThread]: On master: BEGIN
[0m23:45:26.400681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:26.400681 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m23:45:26.400681 [debug] [MainThread]: On master: COMMIT
[0m23:45:26.410295 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:26.411858 [debug] [MainThread]: On master: COMMIT
[0m23:45:26.413881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:26.413881 [debug] [MainThread]: On master: Close
[0m23:45:26.463334 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:45:26.465495 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:45:26.467512 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:45:26.470015 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:45:26.503294 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:45:26.505865 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:45:26.663288 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:45:26.663288 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:45:26.663288 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:45:26.663288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:26.680190 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:45:26.680703 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:45:26.680703 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Procura qualquer ficheiro CSV na pasta do projeto para evitar erro de caminho absoluto
SELECT * FROM read_csv_auto('*.csv')
  );

[0m23:45:26.853685 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: IO Error: No files found that match the pattern "*.csv"

LINE 8: SELECT * FROM read_csv_auto('*.csv')
                      ^
[0m23:45:26.855270 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Procura qualquer ficheiro CSV na pasta do projeto para evitar erro de caminho absoluto
SELECT * FROM read_csv_auto('*.csv')
  );

[0m23:45:26.855270 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:45:26.857284 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m23:45:26.893518 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:45:26.893518 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:45:26.933421 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "*.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('*.csv')
                        ^
[0m23:45:26.933421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c049ac0-36b6-4475-921b-7f66851f35c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0CDADB80>]}
[0m23:45:26.933421 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 0.47s]
[0m23:45:26.933421 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:45:26.943075 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "*.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('*.csv')
                        ^.
[0m23:45:26.945624 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:45:26.948741 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.stg_terceirizados .................................... [[33mSKIP[0m]
[0m23:45:26.950256 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:45:26.952827 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:45:26.954238 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:45:26.954238 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:45:26.961913 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:26.962984 [debug] [MainThread]: On master: BEGIN
[0m23:45:26.963999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:26.969268 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m23:45:26.974202 [debug] [MainThread]: On master: COMMIT
[0m23:45:26.974202 [debug] [MainThread]: Using duckdb connection "master"
[0m23:45:26.978266 [debug] [MainThread]: On master: COMMIT
[0m23:45:26.982451 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:45:26.984812 [debug] [MainThread]: On master: Close
[0m23:45:26.984812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:26.984812 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:45:26.984812 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:45:26.993551 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m23:45:26.995307 [info ] [MainThread]: 
[0m23:45:26.997472 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m23:45:26.997472 [debug] [MainThread]: Command end result
[0m23:45:27.112368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:45:27.120064 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:45:27.143133 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:45:27.145463 [info ] [MainThread]: 
[0m23:45:27.147077 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:45:27.150797 [info ] [MainThread]: 
[0m23:45:27.153030 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m23:45:27.156546 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "*.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('*.csv')
                        ^
[0m23:45:27.156546 [info ] [MainThread]: 
[0m23:45:27.163455 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m23:45:27.166379 [info ] [MainThread]: 
[0m23:45:27.166379 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m23:45:27.172161 [debug] [MainThread]: Command `dbt run` failed at 23:45:27.171121 after 10.04 seconds
[0m23:45:27.174422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE09ED8C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C3CFB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C3CF860>]}
[0m23:45:27.177549 [debug] [MainThread]: Flushing usage events
[0m23:45:29.273004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:14.915146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AC6CD070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AEEE9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AEEE9BB0>]}


============================== 23:51:14.923248 | 06c26655-824f-47a4-b292-32d0ee0f6fce ==============================
[0m23:51:14.923248 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:51:14.924305 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:51:14.931900 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.silver.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m23:51:14.932963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06c26655-824f-47a4-b292-32d0ee0f6fce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AEEE9850>]}
[0m23:51:15.490602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c26655-824f-47a4-b292-32d0ee0f6fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AF2423C0>]}
[0m23:51:15.571676 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:51:15.572888 [debug] [MainThread]: Command `dbt clean` succeeded at 23:51:15.572888 after 1.43 seconds
[0m23:51:15.574772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B0D19DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B0D19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AC6CD070>]}
[0m23:51:15.575848 [debug] [MainThread]: Flushing usage events
[0m23:51:16.780994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:37.553222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52916C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52916FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E529547B60>]}


============================== 23:51:37.565124 | 0d49420a-e87a-45c3-b637-0fe662efcb12 ==============================
[0m23:51:37.565124 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:51:37.567011 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt run --full-refresh', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:51:38.711764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E529544EC0>]}
[0m23:51:38.893788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52964FA70>]}
[0m23:51:38.897906 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:51:39.579097 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:51:39.581106 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:51:39.583115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52B4E3110>]}
[0m23:51:41.794257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52B7D02C0>]}
[0m23:51:41.886696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:51:41.888718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:51:41.940564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52BA2BD70>]}
[0m23:51:41.940564 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:51:41.940564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52B937EC0>]}
[0m23:51:41.982112 [info ] [MainThread]: 
[0m23:51:41.984178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:41.984178 [info ] [MainThread]: 
[0m23:51:41.986203 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:51:41.996596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:51:42.407876 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:51:42.408948 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:51:42.409948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:43.910205 [debug] [ThreadPool]: SQL status: OK in 1.500 seconds
[0m23:51:43.910205 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:51:43.910205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:51:43.910205 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:51:43.927321 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:51:43.929328 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:51:43.929328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:43.932933 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:51:43.934690 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:51:43.935588 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:51:43.935588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:43.935588 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:51:43.935588 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:51:43.935588 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:43.941210 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:51:43.941210 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:51:43.942219 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:51:43.943219 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:43.943219 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:51:43.946220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:51:43.956992 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:51:43.956992 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:51:43.956992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:43.956992 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:51:43.956992 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:51:43.956992 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:51:43.993389 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m23:51:43.993389 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:51:43.993389 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:51:43.993389 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:51:44.003743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52BD24C80>]}
[0m23:51:44.003743 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:44.003743 [debug] [MainThread]: On master: BEGIN
[0m23:51:44.003743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:44.006019 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:51:44.006019 [debug] [MainThread]: On master: COMMIT
[0m23:51:44.006019 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:44.006019 [debug] [MainThread]: On master: COMMIT
[0m23:51:44.006019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:44.006019 [debug] [MainThread]: On master: Close
[0m23:51:44.050123 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:51:44.052047 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:51:44.055076 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:51:44.055076 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:51:44.074283 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:51:44.079310 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:51:44.155124 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:51:44.162504 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:51:44.163760 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:51:44.165473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:44.168066 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:51:44.168066 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:51:44.168066 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- L√™ todos os ficheiros CSV que comecem por 'terceirizados' na sua pasta de projeto
SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados*.csv')
  );

[0m23:51:44.192521 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados*.csv"

LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados*.csv')
                      ^
[0m23:51:44.194589 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- L√™ todos os ficheiros CSV que comecem por 'terceirizados' na sua pasta de projeto
SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados*.csv')
  );

[0m23:51:44.194589 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:44.195589 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m23:51:44.200555 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:51:44.201625 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:51:44.214137 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados*.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados*.csv')
                        ^
[0m23:51:44.218033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d49420a-e87a-45c3-b637-0fe662efcb12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52BEE4680>]}
[0m23:51:44.219644 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 0.16s]
[0m23:51:44.221270 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:51:44.222355 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados*.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados*.csv')
                        ^.
[0m23:51:44.224988 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:51:44.226587 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.stg_terceirizados .................................... [[33mSKIP[0m]
[0m23:51:44.227717 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:51:44.228864 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:51:44.229406 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:51:44.230476 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:51:44.232037 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:44.233369 [debug] [MainThread]: On master: BEGIN
[0m23:51:44.233369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:44.236381 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:51:44.236889 [debug] [MainThread]: On master: COMMIT
[0m23:51:44.237899 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:44.239963 [debug] [MainThread]: On master: COMMIT
[0m23:51:44.242640 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:44.243721 [debug] [MainThread]: On master: Close
[0m23:51:44.244795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:44.245468 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:51:44.246001 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:51:44.246535 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m23:51:44.247670 [info ] [MainThread]: 
[0m23:51:44.248750 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m23:51:44.250863 [debug] [MainThread]: Command end result
[0m23:51:44.296219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:51:44.305320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:51:44.322583 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:51:44.323960 [info ] [MainThread]: 
[0m23:51:44.324547 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:51:44.325554 [info ] [MainThread]: 
[0m23:51:44.326554 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m23:51:44.327579 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "C:/desafio_iplanrio/terceirizados*.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('C:/desafio_iplanrio/terceirizados*.csv')
                        ^
[0m23:51:44.328574 [info ] [MainThread]: 
[0m23:51:44.329667 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m23:51:44.329667 [info ] [MainThread]: 
[0m23:51:44.330649 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m23:51:44.331667 [debug] [MainThread]: Command `dbt run` failed at 23:51:44.331667 after 7.36 seconds
[0m23:51:44.332652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E528E3EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52BE04F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E528E68C80>]}
[0m23:51:44.333654 [debug] [MainThread]: Flushing usage events
[0m23:51:46.016096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:54.775872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB3A358B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB3A37560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB3A35F70>]}


============================== 23:53:54.783977 | 41cf3042-a891-4ba7-a176-9899049534b3 ==============================
[0m23:53:54.783977 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:53:54.785976 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:53:54.792787 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.bronze.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m23:53:54.794386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '41cf3042-a891-4ba7-a176-9899049534b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB4103230>]}
[0m23:53:55.429001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41cf3042-a891-4ba7-a176-9899049534b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB4609190>]}
[0m23:53:55.515414 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:53:55.516465 [debug] [MainThread]: Command `dbt clean` succeeded at 23:53:55.516465 after 1.33 seconds
[0m23:53:55.519008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB14AFCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB5F50DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FB45ED610>]}
[0m23:53:55.521683 [debug] [MainThread]: Flushing usage events
[0m23:53:56.777261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:02.183785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2995F6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2995F7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2995F75F0>]}


============================== 23:54:02.188638 | ecfbd0a5-673a-43b3-ad7f-dfb328fee956 ==============================
[0m23:54:02.188638 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:54:02.189371 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:54:02.753058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E297331E20>]}
[0m23:54:02.881967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29ADDBB60>]}
[0m23:54:02.887512 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:54:03.496184 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:54:03.498200 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:54:03.498200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29B28C500>]}
[0m23:54:05.432636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29BA0C1A0>]}
[0m23:54:05.526245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:54:05.528665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:54:05.554857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29BAB41A0>]}
[0m23:54:05.554857 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:54:05.554857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29BA4B6E0>]}
[0m23:54:05.560510 [info ] [MainThread]: 
[0m23:54:05.560510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:05.560510 [info ] [MainThread]: 
[0m23:54:05.565450 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:54:05.576405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:54:05.732292 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:54:05.732292 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:54:05.732292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:06.856717 [debug] [ThreadPool]: SQL status: OK in 1.121 seconds
[0m23:54:06.862104 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:54:06.862104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:54:06.864110 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:54:06.873367 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:54:06.873367 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:54:06.873367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:06.880540 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:54:06.880540 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:54:06.880540 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:54:06.880540 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:54:06.880540 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:54:06.887250 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:54:06.887250 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:54:06.890066 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:54:06.891066 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:54:06.891572 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:54:06.892583 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:54:06.893582 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:54:06.895581 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:54:06.907143 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:54:06.907143 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:54:06.907143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:06.911813 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:54:06.911813 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:54:06.911813 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:54:06.945423 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m23:54:06.947431 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:54:06.949441 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:54:06.949441 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:54:06.953887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E296A33590>]}
[0m23:54:06.955686 [debug] [MainThread]: Using duckdb connection "master"
[0m23:54:06.956337 [debug] [MainThread]: On master: BEGIN
[0m23:54:06.956337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:06.960074 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:54:06.960074 [debug] [MainThread]: On master: COMMIT
[0m23:54:06.960074 [debug] [MainThread]: Using duckdb connection "master"
[0m23:54:06.960074 [debug] [MainThread]: On master: COMMIT
[0m23:54:06.960074 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:54:06.960074 [debug] [MainThread]: On master: Close
[0m23:54:06.974469 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:54:06.974469 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:54:06.974469 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:54:06.974469 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:54:06.996241 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:54:06.997247 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:54:07.047616 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:54:07.056471 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:54:07.057479 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:54:07.058527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:07.062061 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:54:07.062061 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:54:07.062061 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usando o nome exato conforme o sistema de arquivos para evitar o erro IO Error
SELECT * FROM read_csv_auto('terceirizados202501.xlsx - Planilha1.csv')
  );

[0m23:54:07.141664 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: IO Error: No files found that match the pattern "terceirizados202501.xlsx - Planilha1.csv"

LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx - Planilha1.csv')
                      ^
[0m23:54:07.141664 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usando o nome exato conforme o sistema de arquivos para evitar o erro IO Error
SELECT * FROM read_csv_auto('terceirizados202501.xlsx - Planilha1.csv')
  );

[0m23:54:07.141664 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:54:07.141664 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m23:54:07.141664 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:54:07.141664 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:54:07.160274 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "terceirizados202501.xlsx - Planilha1.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx - Planilha1.csv')
                        ^
[0m23:54:07.162796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecfbd0a5-673a-43b3-ad7f-dfb328fee956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29BF08C50>]}
[0m23:54:07.165896 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 0.19s]
[0m23:54:07.165896 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:54:07.165896 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "terceirizados202501.xlsx - Planilha1.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx - Planilha1.csv')
                        ^.
[0m23:54:07.165896 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:54:07.165896 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.stg_terceirizados .................................... [[33mSKIP[0m]
[0m23:54:07.172318 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:54:07.173002 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:54:07.175436 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:54:07.175436 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:54:07.178782 [debug] [MainThread]: Using duckdb connection "master"
[0m23:54:07.178782 [debug] [MainThread]: On master: BEGIN
[0m23:54:07.179785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:07.181776 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:54:07.181776 [debug] [MainThread]: On master: COMMIT
[0m23:54:07.181776 [debug] [MainThread]: Using duckdb connection "master"
[0m23:54:07.183286 [debug] [MainThread]: On master: COMMIT
[0m23:54:07.183286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:54:07.183286 [debug] [MainThread]: On master: Close
[0m23:54:07.183286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:07.185803 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:54:07.185803 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:54:07.185803 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m23:54:07.185803 [info ] [MainThread]: 
[0m23:54:07.185803 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m23:54:07.189593 [debug] [MainThread]: Command end result
[0m23:54:07.224464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:54:07.229160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:54:07.240015 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:54:07.241002 [info ] [MainThread]: 
[0m23:54:07.242570 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:54:07.242570 [info ] [MainThread]: 
[0m23:54:07.242570 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m23:54:07.245466 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  IO Error: No files found that match the pattern "terceirizados202501.xlsx - Planilha1.csv"
  
  LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx - Planilha1.csv')
                        ^
[0m23:54:07.246477 [info ] [MainThread]: 
[0m23:54:07.246477 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m23:54:07.246477 [info ] [MainThread]: 
[0m23:54:07.249187 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m23:54:07.251215 [debug] [MainThread]: Command `dbt run` failed at 23:54:07.251215 after 5.27 seconds
[0m23:54:07.252217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E299917FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29B7F0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E29ADFEE70>]}
[0m23:54:07.253216 [debug] [MainThread]: Flushing usage events
[0m23:54:08.388039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:04.491658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FBEE9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FBEEB380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FBEE95E0>]}


============================== 23:55:04.505039 | d0585d6a-9bf9-40a2-9f08-32e97a53967a ==============================
[0m23:55:04.505039 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:55:04.506720 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:55:04.512085 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.gold.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m23:55:04.512621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0585d6a-9bf9-40a2-9f08-32e97a53967a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE27DEB0>]}
[0m23:55:04.942696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0585d6a-9bf9-40a2-9f08-32e97a53967a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F9913950>]}
[0m23:55:04.988569 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:55:04.998580 [debug] [MainThread]: Command `dbt clean` succeeded at 23:55:04.998580 after 0.86 seconds
[0m23:55:04.999591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FCDC3DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FC16ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FCA51BE0>]}
[0m23:55:05.000591 [debug] [MainThread]: Flushing usage events
[0m23:55:06.282214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:12.462281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AB4D7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273ABF7A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AB4D5760>]}


============================== 23:55:12.466295 | 877df894-5313-4e5d-95f8-b32e49364856 ==============================
[0m23:55:12.466295 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:55:12.466295 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt run --full-refresh', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m23:55:12.962864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273ADA874D0>]}
[0m23:55:13.076129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AB856780>]}
[0m23:55:13.076129 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m23:55:13.351439 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:55:13.353453 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:55:13.353453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273ADBC7530>]}
[0m23:55:15.119788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AE0D02C0>]}
[0m23:55:15.184047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:55:15.188557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:55:15.209310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AE0D1EB0>]}
[0m23:55:15.209310 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m23:55:15.213746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AD9DB710>]}
[0m23:55:15.215247 [info ] [MainThread]: 
[0m23:55:15.222236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:55:15.223146 [info ] [MainThread]: 
[0m23:55:15.224220 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:55:15.232588 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m23:55:15.338281 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m23:55:15.339282 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m23:55:15.339282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:16.456587 [debug] [ThreadPool]: SQL status: OK in 1.118 seconds
[0m23:55:16.456587 [debug] [ThreadPool]: On list_terceirizados: Close
[0m23:55:16.456587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m23:55:16.456587 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m23:55:16.474826 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:55:16.474826 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m23:55:16.474826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:16.474826 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m23:55:16.482807 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:55:16.482807 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m23:55:16.482807 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:55:16.482807 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:55:16.485321 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m23:55:16.485321 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:55:16.488416 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:55:16.489918 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m23:55:16.489918 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m23:55:16.489918 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:55:16.489918 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m23:55:16.495698 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m23:55:16.498587 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:55:16.498587 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m23:55:16.498587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:16.507318 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:55:16.507318 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m23:55:16.509881 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m23:55:16.553610 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m23:55:16.557308 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m23:55:16.559843 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m23:55:16.560845 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m23:55:16.562712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AE17E2A0>]}
[0m23:55:16.563270 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:16.563270 [debug] [MainThread]: On master: BEGIN
[0m23:55:16.563270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:16.565302 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:55:16.565302 [debug] [MainThread]: On master: COMMIT
[0m23:55:16.567417 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:16.567417 [debug] [MainThread]: On master: COMMIT
[0m23:55:16.567417 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:55:16.568997 [debug] [MainThread]: On master: Close
[0m23:55:16.612299 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m23:55:16.612299 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m23:55:16.614311 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:55:16.614311 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m23:55:16.627236 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:55:16.630384 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m23:55:16.690142 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m23:55:16.694273 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:55:16.694273 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m23:55:16.694273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:55:16.694273 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:55:16.694273 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m23:55:16.694273 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usando o nome exato conforme o sistema de arquivos para evitar o erro IO Error
SELECT * FROM read_csv_auto('terceirizados202501.xlsx')
  );

[0m23:55:16.747248 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Invalid Input Error: Error when sniffing file "terceirizados202501.xlsx".
It was not possible to automatically detect the CSV parsing dialect
The search space used was:
Delimiter Candidates: ',', '|', ';', '	'
Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
Comment Candidates: '\0', '#'
Encoding: utf-8
Possible fixes:
* Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
* Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
* Set delimiter (e.g., delim=',')
* Set quote (e.g., quote='"')
* Set escape (e.g., escape='"')
* Set comment (e.g., comment='#')
* Set skip (skip=${n}) to skip ${n} lines at the top of the file
* Enable ignore errors (ignore_errors=true) to ignore potential errors
* Enable null padding (null_padding=true) to pad missing columns with NULL values
* Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
* Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)


LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx')
                      ^
[0m23:55:16.747248 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Usando o nome exato conforme o sistema de arquivos para evitar o erro IO Error
SELECT * FROM read_csv_auto('terceirizados202501.xlsx')
  );

[0m23:55:16.747248 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:55:16.747248 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m23:55:16.757346 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m23:55:16.759091 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m23:55:16.770485 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  Invalid Input Error: Error when sniffing file "terceirizados202501.xlsx".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ',', '|', ';', '	'
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Set delimiter (e.g., delim=',')
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx')
                        ^
[0m23:55:16.775520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877df894-5313-4e5d-95f8-b32e49364856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AB4FEAB0>]}
[0m23:55:16.776527 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 0.16s]
[0m23:55:16.778596 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m23:55:16.780603 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  Invalid Input Error: Error when sniffing file "terceirizados202501.xlsx".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ',', '|', ';', '	'
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Set delimiter (e.g., delim=',')
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx')
                        ^.
[0m23:55:16.782610 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m23:55:16.782610 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.stg_terceirizados .................................... [[33mSKIP[0m]
[0m23:55:16.784619 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m23:55:16.784619 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m23:55:16.786630 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m23:55:16.788382 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m23:55:16.790265 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:16.791347 [debug] [MainThread]: On master: BEGIN
[0m23:55:16.791894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:16.794035 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:55:16.795096 [debug] [MainThread]: On master: COMMIT
[0m23:55:16.795651 [debug] [MainThread]: Using duckdb connection "master"
[0m23:55:16.796205 [debug] [MainThread]: On master: COMMIT
[0m23:55:16.797285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:55:16.797820 [debug] [MainThread]: On master: Close
[0m23:55:16.798893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:16.799427 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m23:55:16.799973 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m23:55:16.800520 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m23:55:16.801056 [info ] [MainThread]: 
[0m23:55:16.802128 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m23:55:16.803730 [debug] [MainThread]: Command end result
[0m23:55:16.840460 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m23:55:16.844101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m23:55:16.854724 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m23:55:16.855341 [info ] [MainThread]: 
[0m23:55:16.857501 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:55:16.858535 [info ] [MainThread]: 
[0m23:55:16.859575 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m23:55:16.861380 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  Invalid Input Error: Error when sniffing file "terceirizados202501.xlsx".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ',', '|', ';', '	'
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Set delimiter (e.g., delim=',')
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 8: SELECT * FROM read_csv_auto('terceirizados202501.xlsx')
                        ^
[0m23:55:16.862975 [info ] [MainThread]: 
[0m23:55:16.864498 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m23:55:16.865032 [info ] [MainThread]: 
[0m23:55:16.866551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m23:55:16.869587 [debug] [MainThread]: Command `dbt run` failed at 23:55:16.868563 after 4.60 seconds
[0m23:55:16.869587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273ABEF86E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273ABF7A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273AC0184D0>]}
[0m23:55:16.869587 [debug] [MainThread]: Flushing usage events
[0m23:55:17.849918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:34.601176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA0015070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA5303920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA5303740>]}


============================== 00:03:34.616303 | 6d5b85a9-e73e-488c-b82f-ba7e0dcb176a ==============================
[0m00:03:34.616303 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:03:34.621362 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:03:34.626407 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.silver.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m00:03:34.626407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d5b85a9-e73e-488c-b82f-ba7e0dcb176a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA3A65370>]}
[0m00:03:35.058747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d5b85a9-e73e-488c-b82f-ba7e0dcb176a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA0E7FDD0>]}
[0m00:03:35.154086 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:03:35.155784 [debug] [MainThread]: Command `dbt clean` succeeded at 00:03:35.154663 after 0.96 seconds
[0m00:03:35.155784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA36971A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA5915790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CA593D250>]}
[0m00:03:35.156759 [debug] [MainThread]: Flushing usage events
[0m00:03:36.282847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:46.100785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6E43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6E43E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6E43BC0>]}


============================== 00:03:46.105785 | 98fb04c0-c493-40cc-99dd-3d4a9e3a9161 ==============================
[0m00:03:46.105785 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:03:46.107784 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:03:46.785184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE29B3CE0>]}
[0m00:03:47.012505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE44AFD70>]}
[0m00:03:47.017344 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m00:03:47.859901 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m00:03:47.860907 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:03:47.865207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7634230>]}
[0m00:03:50.810297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE798EF90>]}
[0m00:03:51.017410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:03:51.028024 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:03:51.073259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7AFC770>]}
[0m00:03:51.073259 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m00:03:51.080963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6FF1F10>]}
[0m00:03:51.088611 [info ] [MainThread]: 
[0m00:03:51.089291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:51.091331 [info ] [MainThread]: 
[0m00:03:51.091331 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:03:51.107216 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m00:03:51.436671 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m00:03:51.436671 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m00:03:51.436671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:52.701391 [debug] [ThreadPool]: SQL status: OK in 1.259 seconds
[0m00:03:52.705152 [debug] [ThreadPool]: On list_terceirizados: Close
[0m00:03:52.706234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m00:03:52.707849 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m00:03:52.718042 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:03:52.719623 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m00:03:52.720682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:52.724412 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:03:52.727616 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:03:52.728676 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m00:03:52.730907 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:52.730907 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:03:52.731924 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m00:03:52.738819 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m00:03:52.740903 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:03:52.741895 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:03:52.742429 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:03:52.744562 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:52.745207 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m00:03:52.748278 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m00:03:52.756176 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:03:52.758181 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m00:03:52.758181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:52.762885 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:03:52.763896 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:03:52.765047 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m00:03:52.814188 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m00:03:52.814695 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m00:03:52.814695 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m00:03:52.814695 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m00:03:52.822173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7551FD0>]}
[0m00:03:52.822173 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:52.822173 [debug] [MainThread]: On master: BEGIN
[0m00:03:52.824301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:52.824301 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m00:03:52.824301 [debug] [MainThread]: On master: COMMIT
[0m00:03:52.824301 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:52.830068 [debug] [MainThread]: On master: COMMIT
[0m00:03:52.830574 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:52.830574 [debug] [MainThread]: On master: Close
[0m00:03:52.867058 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m00:03:52.871495 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m00:03:52.871495 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m00:03:52.873520 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m00:03:52.889959 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:03:52.894323 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m00:03:52.981930 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:03:52.987392 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:03:52.987392 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m00:03:52.987392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:03:52.987392 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:03:52.987392 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:03:52.987392 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

SELECT * FROM read_csv_auto('dados.csv')
  );

[0m00:03:53.508627 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Invalid Input Error: CSV Error on Line: 2
Original Line: id_terc;sg_orgao_sup_tabela_ug;cd_ug_gestora;nm_ug_tabela_ug;sg_ug_gestora;nr_contrato;nr_cnpj;nm_razao_social;nr_cpf;nm_terceirizado;nm_categoria_profissional;nm_escolaridade;nr_jornada;nm_unidade_prestacao;vl_mensal_salario;vl_mensal_custo;Num_Mes_Carga;Mes_Carga;Ano_Carga;sg_orgao;nm_orgao;cd_orgao_siafi;cd_orgao_siape
Invalid unicode (byte sequence mismatch) detected. This file is not utf-8 encoded.

Possible Solution: Set the correct encoding, if available, to read this CSV File (e.g., encoding='UTF-16')
Possible Solution: Enable ignore errors (ignore_errors=true) to skip this row

  file = dados.csv
  delimiter = , (Auto-Detected)
  quote = " (Auto-Detected)
  escape = (empty) (Auto-Detected)
  new_line = Single-Line File (Auto-Detected)
  header = false (Auto-Detected)
  skip_rows = 0 (Auto-Detected)
  comment = (empty) (Auto-Detected)
  strict_mode = true (Auto-Detected)
  date_format =  (Auto-Detected)
  timestamp_format =  (Auto-Detected)
  null_padding = 0
  sample_size = 20480
  ignore_errors = false
  all_varchar = 0



LINE 7: SELECT * FROM read_csv_auto('dados.csv')
                      ^
[0m00:03:53.510653 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

SELECT * FROM read_csv_auto('dados.csv')
  );

[0m00:03:53.512668 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:03:53.512668 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: ROLLBACK
[0m00:03:53.521060 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.terceirizados_bronze'
[0m00:03:53.524065 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m00:03:53.538016 [debug] [Thread-1 (]: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  Invalid Input Error: CSV Error on Line: 2
  Original Line: id_terc;sg_orgao_sup_tabela_ug;cd_ug_gestora;nm_ug_tabela_ug;sg_ug_gestora;nr_contrato;nr_cnpj;nm_razao_social;nr_cpf;nm_terceirizado;nm_categoria_profissional;nm_escolaridade;nr_jornada;nm_unidade_prestacao;vl_mensal_salario;vl_mensal_custo;Num_Mes_Carga;Mes_Carga;Ano_Carga;sg_orgao;nm_orgao;cd_orgao_siafi;cd_orgao_siape
  Invalid unicode (byte sequence mismatch) detected. This file is not utf-8 encoded.
  
  Possible Solution: Set the correct encoding, if available, to read this CSV File (e.g., encoding='UTF-16')
  Possible Solution: Enable ignore errors (ignore_errors=true) to skip this row
  
    file = dados.csv
    delimiter = , (Auto-Detected)
    quote = " (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = Single-Line File (Auto-Detected)
    header = false (Auto-Detected)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  
  
  
  LINE 7: SELECT * FROM read_csv_auto('dados.csv')
                        ^
[0m00:03:53.544246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fb04c0-c493-40cc-99dd-3d4a9e3a9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE4F5E930>]}
[0m00:03:53.549814 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.terceirizados_bronze ................. [[31mERROR[0m in 0.67s]
[0m00:03:53.550464 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m00:03:53.553446 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.terceirizados_bronze' to be skipped because of status 'error'.  Reason: Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  Invalid Input Error: CSV Error on Line: 2
  Original Line: id_terc;sg_orgao_sup_tabela_ug;cd_ug_gestora;nm_ug_tabela_ug;sg_ug_gestora;nr_contrato;nr_cnpj;nm_razao_social;nr_cpf;nm_terceirizado;nm_categoria_profissional;nm_escolaridade;nr_jornada;nm_unidade_prestacao;vl_mensal_salario;vl_mensal_custo;Num_Mes_Carga;Mes_Carga;Ano_Carga;sg_orgao;nm_orgao;cd_orgao_siafi;cd_orgao_siape
  Invalid unicode (byte sequence mismatch) detected. This file is not utf-8 encoded.
  
  Possible Solution: Set the correct encoding, if available, to read this CSV File (e.g., encoding='UTF-16')
  Possible Solution: Enable ignore errors (ignore_errors=true) to skip this row
  
    file = dados.csv
    delimiter = , (Auto-Detected)
    quote = " (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = Single-Line File (Auto-Detected)
    header = false (Auto-Detected)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  
  
  
  LINE 7: SELECT * FROM read_csv_auto('dados.csv')
                        ^.
[0m00:03:53.553446 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m00:03:53.557289 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.stg_terceirizados .................................... [[33mSKIP[0m]
[0m00:03:53.559300 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m00:03:53.561345 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m00:03:53.561345 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m00:03:53.561345 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m00:03:53.567951 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:53.567951 [debug] [MainThread]: On master: BEGIN
[0m00:03:53.569487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:53.576017 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m00:03:53.577018 [debug] [MainThread]: On master: COMMIT
[0m00:03:53.578017 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:53.579016 [debug] [MainThread]: On master: COMMIT
[0m00:03:53.580524 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:53.582983 [debug] [MainThread]: On master: Close
[0m00:03:53.585383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:53.585383 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m00:03:53.588861 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m00:03:53.590375 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados_bronze' was properly closed.
[0m00:03:53.590375 [info ] [MainThread]: 
[0m00:03:53.590375 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m00:03:53.590375 [debug] [MainThread]: Command end result
[0m00:03:53.677356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:03:53.684436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:03:53.705110 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m00:03:53.708110 [info ] [MainThread]: 
[0m00:03:53.712144 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:03:53.715155 [info ] [MainThread]: 
[0m00:03:53.716472 [error] [MainThread]: [31mFailure in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)[0m
[0m00:03:53.718937 [error] [MainThread]:   Runtime Error in model terceirizados_bronze (models\bronze\terceirizados_bronze.sql)
  Invalid Input Error: CSV Error on Line: 2
  Original Line: id_terc;sg_orgao_sup_tabela_ug;cd_ug_gestora;nm_ug_tabela_ug;sg_ug_gestora;nr_contrato;nr_cnpj;nm_razao_social;nr_cpf;nm_terceirizado;nm_categoria_profissional;nm_escolaridade;nr_jornada;nm_unidade_prestacao;vl_mensal_salario;vl_mensal_custo;Num_Mes_Carga;Mes_Carga;Ano_Carga;sg_orgao;nm_orgao;cd_orgao_siafi;cd_orgao_siape
  Invalid unicode (byte sequence mismatch) detected. This file is not utf-8 encoded.
  
  Possible Solution: Set the correct encoding, if available, to read this CSV File (e.g., encoding='UTF-16')
  Possible Solution: Enable ignore errors (ignore_errors=true) to skip this row
  
    file = dados.csv
    delimiter = , (Auto-Detected)
    quote = " (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = Single-Line File (Auto-Detected)
    header = false (Auto-Detected)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  
  
  
  LINE 7: SELECT * FROM read_csv_auto('dados.csv')
                        ^
[0m00:03:53.719959 [info ] [MainThread]: 
[0m00:03:53.721047 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\bronze\terceirizados_bronze.sql
[0m00:03:53.721555 [info ] [MainThread]: 
[0m00:03:53.721555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m00:03:53.725381 [debug] [MainThread]: Command `dbt run` failed at 00:03:53.723373 after 7.84 seconds
[0m00:03:53.725381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6E550D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6E43E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE6E43860>]}
[0m00:03:53.725381 [debug] [MainThread]: Flushing usage events
[0m00:03:55.082835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:05:55.536602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C86155070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C89F69220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C89C55220>]}


============================== 00:05:55.553439 | 076551c1-a793-4dc8-a72f-676e62867b8a ==============================
[0m00:05:55.553439 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:05:55.555455 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:05:55.567895 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.silver.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m00:05:55.567895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '076551c1-a793-4dc8-a72f-676e62867b8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C8A4A5C10>]}
[0m00:05:56.379448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '076551c1-a793-4dc8-a72f-676e62867b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C8A009E80>]}
[0m00:05:56.511425 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:05:56.514436 [debug] [MainThread]: Command `dbt clean` succeeded at 00:05:56.514436 after 2.62 seconds
[0m00:05:56.515070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C89C950D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C89C97CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C89C94EF0>]}
[0m00:05:56.517361 [debug] [MainThread]: Flushing usage events
[0m00:05:57.936613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:14.260904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31795AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E316D73380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E316D721B0>]}


============================== 00:06:14.278433 | c20bc92c-ab42-420c-87e3-ddf18f08d9c8 ==============================
[0m00:06:14.278433 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:06:14.285330 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:06:16.118667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3153B3CE0>]}
[0m00:06:16.298758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3185366F0>]}
[0m00:06:16.305624 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m00:06:17.135198 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m00:06:17.137214 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:06:17.139223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E318916C00>]}
[0m00:06:19.228354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31A53C8F0>]}
[0m00:06:19.312047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:06:19.312047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:06:19.366513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31A5EE510>]}
[0m00:06:19.366513 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m00:06:19.368519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31A58B920>]}
[0m00:06:19.391002 [info ] [MainThread]: 
[0m00:06:19.391002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:19.391002 [info ] [MainThread]: 
[0m00:06:19.395313 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:06:19.405994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m00:06:19.593429 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m00:06:19.594438 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m00:06:19.594438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:21.033189 [debug] [ThreadPool]: SQL status: OK in 1.438 seconds
[0m00:06:21.036792 [debug] [ThreadPool]: On list_terceirizados: Close
[0m00:06:21.036792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m00:06:21.036792 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m00:06:21.052261 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:06:21.052261 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m00:06:21.052261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:21.057803 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:06:21.059835 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:06:21.061345 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m00:06:21.061345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:21.061345 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:06:21.063370 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m00:06:21.066061 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:06:21.068338 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:06:21.068338 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:06:21.070114 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:06:21.070114 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:06:21.072124 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m00:06:21.074134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m00:06:21.082708 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:06:21.082708 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m00:06:21.082708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:21.082708 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:06:21.089066 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:06:21.089066 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m00:06:21.138069 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m00:06:21.140719 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m00:06:21.140719 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m00:06:21.140719 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m00:06:21.146135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3188F0470>]}
[0m00:06:21.148904 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:21.149914 [debug] [MainThread]: On master: BEGIN
[0m00:06:21.150548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:21.151057 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:06:21.153490 [debug] [MainThread]: On master: COMMIT
[0m00:06:21.153490 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:21.153490 [debug] [MainThread]: On master: COMMIT
[0m00:06:21.153490 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:06:21.155505 [debug] [MainThread]: On master: Close
[0m00:06:21.174427 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m00:06:21.174427 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m00:06:21.174427 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m00:06:21.174427 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m00:06:21.193942 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.197169 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m00:06:21.244237 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.250885 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.252904 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m00:06:21.252904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:06:21.254912 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:06:21.254912 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.254912 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Configuramos o delimitador como ';' e habilitamos a detec√ß√£o autom√°tica de codifica√ß√£o (latin1/ISO-8859-1)
SELECT * FROM read_csv_auto(
    'dados.csv', 
    delim=';', 
    header=True,
    ignore_errors=True
)
  );

[0m00:06:21.539618 [debug] [Thread-1 (]: SQL status: OK in 0.287 seconds
[0m00:06:21.545205 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.545205 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m00:06:21.556137 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:06:21.571998 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:06:21.571998 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.571998 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:06:21.576683 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:06:21.585202 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:06:21.585202 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m00:06:21.588082 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:06:21.588082 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m00:06:21.608572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3153B2ED0>]}
[0m00:06:21.608572 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.41s]
[0m00:06:21.618832 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m00:06:21.619436 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m00:06:21.619436 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m00:06:21.619436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m00:06:21.624095 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m00:06:21.628429 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:06:21.631025 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m00:06:21.660350 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:06:21.665807 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:06:21.665807 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m00:06:21.665807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:21.670487 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:06:21.670487 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:06:21.670487 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento fiel √† sua planilha Excel/CSV
    CAST(id_terc AS STRING) AS id_terceirizado,
    INITCAP(nm_terceirizado) AS terceirizado_nome,
    UPPER(sg_orgao_sup) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal AS DECIMAL(18,2)) AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m00:06:21.878400 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Catalog Error: Scalar Function with name initcap does not exist!
Did you mean "ilike_escape"?

LINE 20:     INITCAP(nm_terceirizado) AS terceirizado_nome,
             ^
[0m00:06:21.878400 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento fiel √† sua planilha Excel/CSV
    CAST(id_terc AS STRING) AS id_terceirizado,
    INITCAP(nm_terceirizado) AS terceirizado_nome,
    UPPER(sg_orgao_sup) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal AS DECIMAL(18,2)) AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m00:06:21.878400 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:06:21.878400 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m00:06:21.883174 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m00:06:21.883174 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m00:06:21.888549 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "ilike_escape"?
  
  LINE 20:     INITCAP(nm_terceirizado) AS terceirizado_nome,
               ^
[0m00:06:21.888549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20bc92c-ab42-420c-87e3-ddf18f08d9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31A056D20>]}
[0m00:06:21.888549 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.stg_terceirizados ................... [[31mERROR[0m in 0.27s]
[0m00:06:21.888549 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m00:06:21.888549 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "ilike_escape"?
  
  LINE 20:     INITCAP(nm_terceirizado) AS terceirizado_nome,
               ^.
[0m00:06:21.900822 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m00:06:21.900822 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m00:06:21.900822 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m00:06:21.904818 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:21.904818 [debug] [MainThread]: On master: BEGIN
[0m00:06:21.905862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:21.907826 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:06:21.907826 [debug] [MainThread]: On master: COMMIT
[0m00:06:21.907826 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:21.909359 [debug] [MainThread]: On master: COMMIT
[0m00:06:21.909359 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:06:21.910388 [debug] [MainThread]: On master: Close
[0m00:06:21.910388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:21.910388 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m00:06:21.910388 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m00:06:21.910388 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m00:06:21.910388 [info ] [MainThread]: 
[0m00:06:21.910388 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m00:06:21.910388 [debug] [MainThread]: Command end result
[0m00:06:21.941958 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:06:21.950370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:06:21.950881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m00:06:21.950881 [info ] [MainThread]: 
[0m00:06:21.950881 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:06:21.950881 [info ] [MainThread]: 
[0m00:06:21.950881 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m00:06:21.960723 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "ilike_escape"?
  
  LINE 20:     INITCAP(nm_terceirizado) AS terceirizado_nome,
               ^
[0m00:06:21.960723 [info ] [MainThread]: 
[0m00:06:21.960723 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m00:06:21.960723 [info ] [MainThread]: 
[0m00:06:21.960723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m00:06:21.966629 [debug] [MainThread]: Command `dbt run` failed at 00:06:21.960723 after 8.67 seconds
[0m00:06:21.966629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E318027200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E318027E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E316D721B0>]}
[0m00:06:21.967683 [debug] [MainThread]: Flushing usage events
[0m00:06:23.119803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:08:03.753819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB29D44200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB29D45490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB29D45310>]}


============================== 00:08:03.764173 | 3962b9b2-434f-49de-83e6-379794903047 ==============================
[0m00:08:03.764173 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:08:03.764173 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:08:04.814469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB258B3A70>]}
[0m00:08:04.933570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2A29DE20>]}
[0m00:08:04.933570 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m00:08:05.582073 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m00:08:05.866132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:08:05.868176 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m00:08:06.460884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2AA5BC50>]}
[0m00:08:06.575144 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:08:06.580194 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:08:06.643628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2A6F92E0>]}
[0m00:08:06.645637 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m00:08:06.647783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2A791F70>]}
[0m00:08:06.656706 [info ] [MainThread]: 
[0m00:08:06.656706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:06.658714 [info ] [MainThread]: 
[0m00:08:06.658714 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:08:06.671918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m00:08:06.953326 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m00:08:06.956329 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m00:08:06.956329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:08.007874 [debug] [ThreadPool]: SQL status: OK in 1.051 seconds
[0m00:08:08.007874 [debug] [ThreadPool]: On list_terceirizados: Close
[0m00:08:08.007874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m00:08:08.007874 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m00:08:08.025164 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:08:08.025164 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m00:08:08.025164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:08.027190 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:08:08.032580 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:08:08.032580 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m00:08:08.033653 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:08:08.033653 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:08:08.033653 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m00:08:08.035720 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:08:08.039119 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:08:08.040119 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:08:08.041119 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:08:08.042119 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:08:08.042119 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m00:08:08.045823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m00:08:08.128749 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:08:08.128749 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m00:08:08.130827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:08.130827 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:08:08.130827 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:08:08.130827 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m00:08:08.170018 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:08:08.173524 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m00:08:08.176075 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m00:08:08.176075 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m00:08:08.176075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2A6AD1F0>]}
[0m00:08:08.176075 [debug] [MainThread]: Using duckdb connection "master"
[0m00:08:08.176075 [debug] [MainThread]: On master: BEGIN
[0m00:08:08.180328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:08:08.181881 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m00:08:08.181881 [debug] [MainThread]: On master: COMMIT
[0m00:08:08.184962 [debug] [MainThread]: Using duckdb connection "master"
[0m00:08:08.184962 [debug] [MainThread]: On master: COMMIT
[0m00:08:08.184962 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:08:08.184962 [debug] [MainThread]: On master: Close
[0m00:08:08.259812 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m00:08:08.259812 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m00:08:08.260811 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m00:08:08.262322 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m00:08:08.272555 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.301409 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m00:08:08.355655 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.357175 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.357175 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m00:08:08.357175 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:08:08.361212 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:08:08.361212 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.361212 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- Configuramos o delimitador como ';' e habilitamos a detec√ß√£o autom√°tica de codifica√ß√£o (latin1/ISO-8859-1)
SELECT * FROM read_csv_auto(
    'dados.csv', 
    delim=';', 
    header=True,
    ignore_errors=True
)
  );

[0m00:08:08.582760 [debug] [Thread-1 (]: SQL status: OK in 0.225 seconds
[0m00:08:08.593072 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.593072 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m00:08:08.593072 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:08:08.614259 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:08:08.614259 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.614259 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:08:08.614259 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:08:08.623893 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:08:08.623893 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m00:08:08.623893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:08:08.623893 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m00:08:08.634045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB258B2F30>]}
[0m00:08:08.634045 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.36s]
[0m00:08:08.638003 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m00:08:08.644671 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m00:08:08.644671 [info ] [Thread-1 (]: 2 of 3 START sql table model main.stg_terceirizados ............................ [RUN]
[0m00:08:08.644671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m00:08:08.644671 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m00:08:08.652019 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:08.655541 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m00:08:08.683149 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:08.686818 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:08.686818 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m00:08:08.686818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:08.690769 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:08:08.690769 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:08.690769 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados__dbt_tmp"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento das colunas da sua planilha real
    CAST(id_terc AS STRING) AS id_terceirizado,
    
    -- Substituindo INITCAP por uma alternativa segura
    UPPER(LEFT(nm_terceirizado, 1)) || LOWER(SUBSTRING(nm_terceirizado, 2)) AS terceirizado_nome,
    
    UPPER(sg_orgao_sup_tabela_ug) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal_salario AS DECIMAL(18,2)) AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze
    );
  
  
[0m00:08:08.990535 [debug] [Thread-1 (]: SQL status: OK in 0.298 seconds
[0m00:08:09.003888 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:09.009733 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */
alter table "terceirizados"."main"."stg_terceirizados__dbt_tmp" rename to "stg_terceirizados"
[0m00:08:09.015478 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:08:09.020072 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m00:08:09.024885 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:09.024885 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m00:08:09.103389 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m00:08:09.110098 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:08:09.111094 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

      drop table if exists "terceirizados"."main"."stg_terceirizados__dbt_backup" cascade
    
[0m00:08:09.113095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:08:09.116738 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m00:08:09.117765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2AE0C200>]}
[0m00:08:09.118762 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.stg_terceirizados ....................... [[32mOK[0m in 0.47s]
[0m00:08:09.119747 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m00:08:09.121747 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m00:08:09.122748 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m00:08:09.127258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m00:08:09.130398 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m00:08:09.142847 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m00:08:09.148529 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m00:08:09.154259 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m00:08:09.160151 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:08:09.160151 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m00:08:09.162159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:09.166202 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:08:09.166202 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:08:09.168232 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    id_terceirizado,
    terceirizado_nome,
    cpf,
    salario_valor,
    orgao_superior_sigla,
    empresa_cnpj,
    CURRENT_TIMESTAMP AS data_carga_datahora,
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m00:08:09.261692 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m00:08:09.264994 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:08:09.264994 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m00:08:09.264994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:08:09.264994 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m00:08:09.264994 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:08:09.264994 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m00:08:09.305255 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m00:08:09.308773 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:08:09.309777 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m00:08:09.310771 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:08:09.313999 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m00:08:09.314389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3962b9b2-434f-49de-83e6-379794903047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB274233E0>]}
[0m00:08:09.315900 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.19s]
[0m00:08:09.316407 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m00:08:09.316407 [debug] [MainThread]: Using duckdb connection "master"
[0m00:08:09.316407 [debug] [MainThread]: On master: BEGIN
[0m00:08:09.316407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:09.316407 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:08:09.316407 [debug] [MainThread]: On master: COMMIT
[0m00:08:09.316407 [debug] [MainThread]: Using duckdb connection "master"
[0m00:08:09.325007 [debug] [MainThread]: On master: COMMIT
[0m00:08:09.325007 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:08:09.325007 [debug] [MainThread]: On master: Close
[0m00:08:09.325007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:09.327019 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m00:08:09.327019 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m00:08:09.327019 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m00:08:09.327019 [info ] [MainThread]: 
[0m00:08:09.329509 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m00:08:09.331644 [debug] [MainThread]: Command end result
[0m00:08:09.378775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:08:09.384278 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:08:09.389036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m00:08:09.389036 [info ] [MainThread]: 
[0m00:08:09.393855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:09.393855 [info ] [MainThread]: 
[0m00:08:09.393855 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:08:09.397180 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:09.397180 after 6.22 seconds
[0m00:08:09.399226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB2AA57470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB28500AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB285023F0>]}
[0m00:08:09.399744 [debug] [MainThread]: Flushing usage events
[0m00:08:10.600660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:00.139347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8035A5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D806951040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D806951820>]}


============================== 00:24:00.218137 | 423bf058-60b2-4c93-ba28-b0572c224116 ==============================
[0m00:24:00.218137 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:24:00.218137 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:24:00.246569 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `materialized` found at
`iplanrio_desafio.bronze.materialized` in file
`C:\desafio_iplanrio\dbt_project.yml`. Hierarchical config values without a '+'
prefix are deprecated in dbt_project.yml.
[0m00:24:00.247577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '423bf058-60b2-4c93-ba28-b0572c224116', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D808D4DE50>]}
[0m00:24:01.167706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '423bf058-60b2-4c93-ba28-b0572c224116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D808D715B0>]}
[0m00:24:01.314018 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:24:01.316018 [debug] [MainThread]: Command `dbt clean` succeeded at 00:24:01.316018 after 2.01 seconds
[0m00:24:01.317023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D805E1C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D807221DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D807047F20>]}
[0m00:24:01.318110 [debug] [MainThread]: Flushing usage events
[0m00:24:02.927445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:20.992388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029183D09280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029183D09430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029183D0AA80>]}


============================== 00:24:21.002392 | c335f3fb-da40-46a6-9890-094f5012ef2b ==============================
[0m00:24:21.002392 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:24:21.002392 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\desafio_iplanrio', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:24:22.415712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029183D81820>]}
[0m00:24:22.548704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029182860860>]}
[0m00:24:22.559277 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m00:24:23.277535 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m00:24:23.280245 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:24:23.282267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029185302600>]}
[0m00:24:25.141983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029185873CE0>]}
[0m00:24:25.222859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:24:25.227495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:24:25.308417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029185985040>]}
[0m00:24:25.308417 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m00:24:25.310425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291859BB680>]}
[0m00:24:25.323878 [info ] [MainThread]: 
[0m00:24:25.324898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:25.325968 [info ] [MainThread]: 
[0m00:24:25.326969 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:24:25.338254 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m00:24:25.721941 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m00:24:25.725410 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m00:24:25.725410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:27.287306 [debug] [ThreadPool]: SQL status: OK in 1.560 seconds
[0m00:24:27.291447 [debug] [ThreadPool]: On list_terceirizados: Close
[0m00:24:27.293444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m00:24:27.295444 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m00:24:27.310176 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:24:27.310176 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m00:24:27.312192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:27.315935 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:24:27.319062 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:24:27.319062 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m00:24:27.321745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:24:27.323048 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:24:27.323048 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m00:24:27.323048 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:24:27.330041 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:24:27.330041 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:24:27.330041 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:24:27.330041 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:24:27.330041 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m00:24:27.339339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m00:24:27.349498 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:24:27.350622 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m00:24:27.350622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:27.354058 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:24:27.355052 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:24:27.355052 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m00:24:27.402325 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m00:24:27.404590 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m00:24:27.407638 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m00:24:27.407638 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m00:24:27.409649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291809AF3B0>]}
[0m00:24:27.411662 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:27.411662 [debug] [MainThread]: On master: BEGIN
[0m00:24:27.411662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:24:27.417238 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m00:24:27.418999 [debug] [MainThread]: On master: COMMIT
[0m00:24:27.419643 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:27.419643 [debug] [MainThread]: On master: COMMIT
[0m00:24:27.422171 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:24:27.422171 [debug] [MainThread]: On master: Close
[0m00:24:27.456489 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m00:24:27.457490 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m00:24:27.459489 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m00:24:27.460489 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m00:24:27.479435 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:27.483433 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m00:24:27.563330 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:27.563330 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:27.569576 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m00:24:27.571123 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:27.571123 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:24:27.571123 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:27.571123 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- O asterisco '*' faz o DuckDB ler o dados.csv, terceirizadosmaio.csv, etc., simultaneamente
SELECT * FROM read_csv_auto(
    '*.csv', 
    delim=';', 
    header=True, 
    ignore_errors=True
)
  );

[0m00:24:27.948945 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m00:24:27.966843 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:27.967842 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m00:24:27.974517 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:24:28.024637 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:24:28.025647 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:28.025647 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:24:28.032765 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m00:24:28.046490 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:24:28.047909 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m00:24:28.051423 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:28.058618 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m00:24:28.075193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291808D6E70>]}
[0m00:24:28.077215 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.60s]
[0m00:24:28.081235 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m00:24:28.083762 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m00:24:28.085515 [info ] [Thread-1 (]: 2 of 3 START sql incremental model main.stg_terceirizados ...................... [RUN]
[0m00:24:28.096996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m00:24:28.098997 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m00:24:28.108181 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:24:28.111565 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m00:24:28.273035 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:24:28.275045 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:24:28.277663 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m00:24:28.278173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:28.281939 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:24:28.281939 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:24:28.283950 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento das colunas da sua planilha real
    CAST(id_terc AS STRING) AS id_terceirizado,
    
    -- Substituindo INITCAP por uma alternativa segura
    UPPER(LEFT(nm_terceirizado, 1)) || LOWER(SUBSTRING(nm_terceirizado, 2)) AS terceirizado_nome,
    
    UPPER(sg_orgao_sup_tabela_ug) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal_salario AS DECIMAL(18,2)) AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze




WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    CAST(id_terc AS STRING) AS id_terceirizado,
    UPPER(LEFT(nm_terceirizado, 1)) || LOWER(SUBSTRING(nm_terceirizado, 2)) AS terceirizado_nome,
    UPPER(sg_orgao_sup_tabela_ug) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal_salario AS DECIMAL(18,2)) AS salario_valor,
    -- Usa a coluna da planilha para definir o m√™s
    CAST(Mes_Carga AS STRING) || '-' || CAST(Ano_Carga AS STRING) AS mes_particao
FROM bronze


    );
  
  
  
[0m00:24:28.294046 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Parser Error: syntax error at or near "WITH"

LINE 34: WITH bronze AS (
         ^
[0m00:24:28.295044 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    -- Mapeamento das colunas da sua planilha real
    CAST(id_terc AS STRING) AS id_terceirizado,
    
    -- Substituindo INITCAP por uma alternativa segura
    UPPER(LEFT(nm_terceirizado, 1)) || LOWER(SUBSTRING(nm_terceirizado, 2)) AS terceirizado_nome,
    
    UPPER(sg_orgao_sup_tabela_ug) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal_salario AS DECIMAL(18,2)) AS salario_valor,
    '2025-01' AS mes_particao
FROM bronze




WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    CAST(id_terc AS STRING) AS id_terceirizado,
    UPPER(LEFT(nm_terceirizado, 1)) || LOWER(SUBSTRING(nm_terceirizado, 2)) AS terceirizado_nome,
    UPPER(sg_orgao_sup_tabela_ug) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal_salario AS DECIMAL(18,2)) AS salario_valor,
    -- Usa a coluna da planilha para definir o m√™s
    CAST(Mes_Carga AS STRING) || '-' || CAST(Ano_Carga AS STRING) AS mes_particao
FROM bronze


    );
  
  
  
[0m00:24:28.296552 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:24:28.296552 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: ROLLBACK
[0m00:24:28.311980 [debug] [Thread-1 (]: Failed to rollback 'model.iplanrio_desafio.stg_terceirizados'
[0m00:24:28.313491 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m00:24:28.328150 [debug] [Thread-1 (]: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Parser Error: syntax error at or near "WITH"
  
  LINE 34: WITH bronze AS (
           ^
[0m00:24:28.330158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c335f3fb-da40-46a6-9890-094f5012ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029186E7CC20>]}
[0m00:24:28.330158 [error] [Thread-1 (]: 2 of 3 ERROR creating sql incremental model main.stg_terceirizados ............. [[31mERROR[0m in 0.23s]
[0m00:24:28.336198 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m00:24:28.337713 [debug] [Thread-4 (]: Marking all children of 'model.iplanrio_desafio.stg_terceirizados' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Parser Error: syntax error at or near "WITH"
  
  LINE 34: WITH bronze AS (
           ^.
[0m00:24:28.340894 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m00:24:28.342904 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.terceirizados ........................................ [[33mSKIP[0m]
[0m00:24:28.345416 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m00:24:28.348417 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:28.349416 [debug] [MainThread]: On master: BEGIN
[0m00:24:28.350419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:24:28.354419 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m00:24:28.355421 [debug] [MainThread]: On master: COMMIT
[0m00:24:28.355421 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:28.356420 [debug] [MainThread]: On master: COMMIT
[0m00:24:28.357420 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:24:28.358418 [debug] [MainThread]: On master: Close
[0m00:24:28.359418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:28.360417 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m00:24:28.361417 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m00:24:28.361417 [debug] [MainThread]: Connection 'model.iplanrio_desafio.stg_terceirizados' was properly closed.
[0m00:24:28.362290 [info ] [MainThread]: 
[0m00:24:28.376713 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m00:24:28.379723 [debug] [MainThread]: Command end result
[0m00:24:28.453000 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:24:28.460833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:24:28.475056 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m00:24:28.477068 [info ] [MainThread]: 
[0m00:24:28.482515 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:24:28.489198 [info ] [MainThread]: 
[0m00:24:28.500631 [error] [MainThread]: [31mFailure in model stg_terceirizados (models\silver\stg_terceirizados.sql)[0m
[0m00:24:28.512925 [error] [MainThread]:   Runtime Error in model stg_terceirizados (models\silver\stg_terceirizados.sql)
  Parser Error: syntax error at or near "WITH"
  
  LINE 34: WITH bronze AS (
           ^
[0m00:24:28.526061 [info ] [MainThread]: 
[0m00:24:28.527062 [info ] [MainThread]:   compiled code at target\compiled\iplanrio_desafio\models\silver\stg_terceirizados.sql
[0m00:24:28.529875 [info ] [MainThread]: 
[0m00:24:28.530904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m00:24:28.536335 [debug] [MainThread]: Command `dbt run` failed at 00:24:28.536335 after 8.11 seconds
[0m00:24:28.539336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029183287770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291838F87A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291828F89E0>]}
[0m00:24:28.540335 [debug] [MainThread]: Flushing usage events
[0m00:24:30.091468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:25:57.614398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F8B07AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F8657C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F5D06C30>]}


============================== 00:25:57.623780 | 9c05882b-feef-4590-89f7-481cc7482b31 ==============================
[0m00:25:57.623780 [info ] [MainThread]: Running with dbt=1.11.6
[0m00:25:57.623780 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\desafio_iplanrio', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --full-refresh', 'use_experimental_parser': 'False', 'log_path': 'C:\\desafio_iplanrio\\logs'}
[0m00:25:58.836923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FA8E5DC0>]}
[0m00:25:59.072215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F83D4CB0>]}
[0m00:25:59.076381 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m00:25:59.843641 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m00:26:00.194067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:26:00.195068 [debug] [MainThread]: Partial parsing: updated file: iplanrio_desafio://models\silver\stg_terceirizados.sql
[0m00:26:00.727867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FAF5C1D0>]}
[0m00:26:00.860548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:26:00.864103 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:26:00.934273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FAF21070>]}
[0m00:26:00.935407 [info ] [MainThread]: Found 3 models, 1 source, 474 macros
[0m00:26:00.936534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FAE47EC0>]}
[0m00:26:00.939473 [info ] [MainThread]: 
[0m00:26:00.940472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:26:00.941471 [info ] [MainThread]: 
[0m00:26:00.943469 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:26:00.954739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados'
[0m00:26:01.136360 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados"
[0m00:26:01.136838 [debug] [ThreadPool]: On list_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"terceirizados"'
    
  
  
[0m00:26:01.136838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:02.458041 [debug] [ThreadPool]: SQL status: OK in 1.320 seconds
[0m00:26:02.461040 [debug] [ThreadPool]: On list_terceirizados: Close
[0m00:26:02.463040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terceirizados, now create_terceirizados_main)
[0m00:26:02.464041 [debug] [ThreadPool]: Creating schema "database: "terceirizados"
schema: "main"
"
[0m00:26:02.579046 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:26:02.581057 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='terceirizados'
        and type='sqlite'
    
  
[0m00:26:02.581057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:02.587527 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m00:26:02.591544 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:26:02.591544 [debug] [ThreadPool]: On create_terceirizados_main: BEGIN
[0m00:26:02.593651 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:26:02.593651 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:26:02.595660 [debug] [ThreadPool]: On create_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "create_terceirizados_main"} */

    
    
        create schema if not exists "terceirizados"."main"
    
[0m00:26:02.601818 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m00:26:02.603844 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:26:02.605855 [debug] [ThreadPool]: Using duckdb connection "create_terceirizados_main"
[0m00:26:02.605855 [debug] [ThreadPool]: On create_terceirizados_main: COMMIT
[0m00:26:02.607864 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:26:02.608874 [debug] [ThreadPool]: On create_terceirizados_main: Close
[0m00:26:02.611932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_terceirizados_main'
[0m00:26:02.622182 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:26:02.622182 [debug] [ThreadPool]: On list_terceirizados_main: BEGIN
[0m00:26:02.622182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:02.622182 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:26:02.622182 [debug] [ThreadPool]: Using duckdb connection "list_terceirizados_main"
[0m00:26:02.622182 [debug] [ThreadPool]: On list_terceirizados_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "connection_name": "list_terceirizados_main"} */
select
      'terceirizados' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'terceirizados'
  
[0m00:26:02.685233 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m00:26:02.687944 [debug] [ThreadPool]: On list_terceirizados_main: ROLLBACK
[0m00:26:02.690942 [debug] [ThreadPool]: Failed to rollback 'list_terceirizados_main'
[0m00:26:02.691944 [debug] [ThreadPool]: On list_terceirizados_main: Close
[0m00:26:02.693944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F84B9D30>]}
[0m00:26:02.695457 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:02.696474 [debug] [MainThread]: On master: BEGIN
[0m00:26:02.697475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:02.701636 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m00:26:02.702264 [debug] [MainThread]: On master: COMMIT
[0m00:26:02.703015 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:02.705024 [debug] [MainThread]: On master: COMMIT
[0m00:26:02.706030 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:26:02.706030 [debug] [MainThread]: On master: Close
[0m00:26:02.739794 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados_bronze
[0m00:26:02.741796 [info ] [Thread-1 (]: 1 of 3 START sql view model main.terceirizados_bronze .......................... [RUN]
[0m00:26:02.744289 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.iplanrio_desafio.terceirizados_bronze'
[0m00:26:02.744289 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados_bronze
[0m00:26:02.759047 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:02.761484 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados_bronze
[0m00:26:02.838281 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:02.840790 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:02.841807 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: BEGIN
[0m00:26:02.842807 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:26:02.845805 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:26:02.846807 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:02.846807 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

  
  create view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" as (
    

-- O asterisco '*' faz o DuckDB ler o dados.csv, terceirizadosmaio.csv, etc., simultaneamente
SELECT * FROM read_csv_auto(
    '*.csv', 
    delim=';', 
    header=True, 
    ignore_errors=True
)
  );

[0m00:26:03.193887 [debug] [Thread-1 (]: SQL status: OK in 0.353 seconds
[0m00:26:03.209250 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:03.209250 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze" rename to "terceirizados_bronze__dbt_backup"
[0m00:26:03.209250 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:26:03.218311 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:03.218311 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */
alter view "terceirizados"."main"."terceirizados_bronze__dbt_tmp" rename to "terceirizados_bronze"
[0m00:26:03.218311 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:26:03.236031 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:26:03.236031 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:03.238124 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: COMMIT
[0m00:26:03.238124 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m00:26:03.250008 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados_bronze"
[0m00:26:03.250008 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados_bronze"} */

      drop view if exists "terceirizados"."main"."terceirizados_bronze__dbt_backup" cascade
    
[0m00:26:03.297979 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m00:26:03.302675 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados_bronze: Close
[0m00:26:03.304683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FAD42510>]}
[0m00:26:03.306691 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.terceirizados_bronze ..................... [[32mOK[0m in 0.56s]
[0m00:26:03.308200 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados_bronze
[0m00:26:03.309226 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.stg_terceirizados
[0m00:26:03.309226 [info ] [Thread-1 (]: 2 of 3 START sql incremental model main.stg_terceirizados ...................... [RUN]
[0m00:26:03.311252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.terceirizados_bronze, now model.iplanrio_desafio.stg_terceirizados)
[0m00:26:03.312759 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.stg_terceirizados
[0m00:26:03.317457 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:26:03.319171 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.stg_terceirizados
[0m00:26:03.391047 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.stg_terceirizados"
[0m00:26:03.391047 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:26:03.393120 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: BEGIN
[0m00:26:03.393120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:26:03.395128 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:26:03.395128 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:26:03.395128 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.stg_terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."stg_terceirizados"
  
    as (
      

WITH bronze AS (
    SELECT * FROM "terceirizados"."main"."terceirizados_bronze"
)

SELECT
    CAST(id_terc AS STRING) AS id_terceirizado,
    -- Usando a alternativa ao INITCAP que funcionou anteriormente
    UPPER(LEFT(nm_terceirizado, 1)) || LOWER(SUBSTRING(nm_terceirizado, 2)) AS terceirizado_nome,
    UPPER(sg_orgao_sup_tabela_ug) AS orgao_superior_sigla,
    nr_cnpj AS empresa_cnpj,
    nr_cpf AS cpf,
    CAST(vl_mensal_salario AS DECIMAL(18,2)) AS salario_valor,
    CAST(Mes_Carga AS STRING) || '-' || CAST(Ano_Carga AS STRING) AS mes_particao
FROM bronze


    );
  
  
  
[0m00:26:04.864109 [debug] [Thread-1 (]: SQL status: OK in 1.466 seconds
[0m00:26:04.873461 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m00:26:04.874472 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.stg_terceirizados"
[0m00:26:04.874472 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: COMMIT
[0m00:26:04.890846 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m00:26:04.895132 [debug] [Thread-1 (]: On model.iplanrio_desafio.stg_terceirizados: Close
[0m00:26:04.896817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FABDF6E0>]}
[0m00:26:04.898074 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model main.stg_terceirizados ................. [[32mOK[0m in 1.58s]
[0m00:26:04.900596 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.stg_terceirizados
[0m00:26:04.902532 [debug] [Thread-1 (]: Began running node model.iplanrio_desafio.terceirizados
[0m00:26:04.902532 [info ] [Thread-1 (]: 3 of 3 START sql table model main.terceirizados ................................ [RUN]
[0m00:26:04.905597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.iplanrio_desafio.stg_terceirizados, now model.iplanrio_desafio.terceirizados)
[0m00:26:04.907160 [debug] [Thread-1 (]: Began compiling node model.iplanrio_desafio.terceirizados
[0m00:26:04.914278 [debug] [Thread-1 (]: Writing injected SQL for node "model.iplanrio_desafio.terceirizados"
[0m00:26:04.916561 [debug] [Thread-1 (]: Began executing node model.iplanrio_desafio.terceirizados
[0m00:26:04.941136 [debug] [Thread-1 (]: Writing runtime sql for node "model.iplanrio_desafio.terceirizados"
[0m00:26:04.941136 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:26:04.943669 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: BEGIN
[0m00:26:04.943669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:26:04.946961 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:26:04.946961 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:26:04.949047 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

  
    
    

    create  table
      "terceirizados"."main"."terceirizados__dbt_tmp"
  
    as (
      

SELECT
    id_terceirizado,
    terceirizado_nome,
    cpf,
    salario_valor,
    orgao_superior_sigla,
    empresa_cnpj,
    CURRENT_TIMESTAMP AS data_carga_datahora,
    mes_particao
FROM "terceirizados"."main"."stg_terceirizados"
    );
  
  
[0m00:26:05.572105 [debug] [Thread-1 (]: SQL status: OK in 0.621 seconds
[0m00:26:05.572105 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:26:05.577131 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */
alter table "terceirizados"."main"."terceirizados__dbt_tmp" rename to "terceirizados"
[0m00:26:05.579155 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:26:05.579155 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m00:26:05.579155 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:26:05.579155 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: COMMIT
[0m00:26:05.599784 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m00:26:05.603549 [debug] [Thread-1 (]: Using duckdb connection "model.iplanrio_desafio.terceirizados"
[0m00:26:05.603549 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "iplanrio_desafio", "target_name": "dev", "node_id": "model.iplanrio_desafio.terceirizados"} */

      drop table if exists "terceirizados"."main"."terceirizados__dbt_backup" cascade
    
[0m00:26:05.603549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:26:05.603549 [debug] [Thread-1 (]: On model.iplanrio_desafio.terceirizados: Close
[0m00:26:05.610869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c05882b-feef-4590-89f7-481cc7482b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1FAA00F20>]}
[0m00:26:05.610869 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.terceirizados ........................... [[32mOK[0m in 0.71s]
[0m00:26:05.610869 [debug] [Thread-1 (]: Finished running node model.iplanrio_desafio.terceirizados
[0m00:26:05.610869 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:05.610869 [debug] [MainThread]: On master: BEGIN
[0m00:26:05.610869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:05.619193 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m00:26:05.620212 [debug] [MainThread]: On master: COMMIT
[0m00:26:05.620719 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:05.620719 [debug] [MainThread]: On master: COMMIT
[0m00:26:05.621729 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:26:05.622732 [debug] [MainThread]: On master: Close
[0m00:26:05.623732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:05.624161 [debug] [MainThread]: Connection 'create_terceirizados_main' was properly closed.
[0m00:26:05.624809 [debug] [MainThread]: Connection 'list_terceirizados_main' was properly closed.
[0m00:26:05.625821 [debug] [MainThread]: Connection 'model.iplanrio_desafio.terceirizados' was properly closed.
[0m00:26:05.625821 [info ] [MainThread]: 
[0m00:26:05.626842 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 1 view model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m00:26:05.629436 [debug] [MainThread]: Command end result
[0m00:26:05.666253 [debug] [MainThread]: Wrote artifact WritableManifest to C:\desafio_iplanrio\target\manifest.json
[0m00:26:05.671164 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\desafio_iplanrio\target\semantic_manifest.json
[0m00:26:05.679685 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\desafio_iplanrio\target\run_results.json
[0m00:26:05.680689 [info ] [MainThread]: 
[0m00:26:05.680689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:26:05.681683 [info ] [MainThread]: 
[0m00:26:05.683192 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:26:05.685050 [debug] [MainThread]: Command `dbt run` succeeded at 00:26:05.685050 after 8.52 seconds
[0m00:26:05.686058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F6378E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F8B07AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1F8428560>]}
[0m00:26:05.686420 [debug] [MainThread]: Flushing usage events
[0m00:26:06.937355 [debug] [MainThread]: An error was encountered while trying to flush usage events
